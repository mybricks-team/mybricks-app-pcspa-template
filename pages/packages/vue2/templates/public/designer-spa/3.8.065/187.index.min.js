"use strict";(self.webpackChunkmybricks=self.webpackChunkmybricks||[]).push([[187],{13985:(e,n,t)=>{t.d(n,{Z:()=>s});var r=t(37009),o=t.n(r),i=t(48814),c=t.n(i)()(o());c.push([e.id,"/**\n * MyBricks Opensource\n * https://mybricks.world\n * This source code is licensed under the MIT license.\n *\n * CheMingjun @2019\n * mybricks@126.com\n */\n/**\n * MyBricks Opensource\n * https://mybricks.world\n * This source code is licensed under the MIT license.\n *\n * CheMingjun @2019\n * mybricks@126.com\n */\n.roles-f84e1 {\n  position: absolute;\n  top: 3px;\n  left: 20px;\n  right: 50px;\n  display: flex;\n  flex-wrap: wrap;\n}\n.roles-f84e1 .curRole-b801b {\n  display: flex;\n  align-items: center;\n  font-size: 10px;\n}\n.roles-f84e1 .curRole-b801b label {\n  margin-right: 5px;\n  color: #999;\n  margin-top: 3px;\n}\n.roles-f84e1 .curRole-b801b span {\n  background: var(--mybricks-color-primary, #FA6400);\n  color: #FFF;\n  font-weight: bold;\n  cursor: pointer;\n  padding: 1px 10px;\n  border-radius: 20px;\n  display: flex;\n  align-items: center;\n}\n.roles-f84e1 .curRole-b801b span svg {\n  margin-left: 5px;\n  height: 9px;\n  width: 9px;\n}\n.roles-f84e1 .curRole-b801b span svg path {\n  fill: #FFF;\n}\n.roles-f84e1 .openMenu-d405a span svg {\n  transform: rotate(180deg);\n}\n.roles-f84e1 .roleMenu-c058d {\n  position: absolute;\n  top: 20px;\n  left: 20px;\n  background: #FFF;\n  border: 1px solid #DDD;\n  border-radius: 5px;\n  padding: 5px;\n  z-index: 1000;\n  box-shadow: 0 2px 4px 2px rgba(39, 54, 78, 0.2);\n  font-size: 10px;\n  color: #333;\n  margin: 2px;\n  min-width: 100px;\n  max-height: 200px;\n  overflow: auto;\n}\n.roles-f84e1 .roleMenu-c058d > div {\n  border-radius: 5px;\n  padding: 2px 10px;\n  cursor: pointer;\n  font-size: 10px;\n  margin: 2px;\n}\n.roles-f84e1 .roleMenu-c058d > div:hover {\n  background: #EEE;\n}\n",""]),c.locals={roles:"roles-f84e1",curRole:"curRole-b801b",openMenu:"openMenu-d405a",roleMenu:"roleMenu-c058d"};const s=c},86229:(e,n,t)=>{t.d(n,{Z:()=>s});var r=t(37009),o=t.n(r),i=t(48814),c=t.n(i)()(o());c.push([e.id,"/**\n * MyBricks Opensource\n * https://mybricks.world\n * This source code is licensed under the MIT license.\n *\n * CheMingjun @2019\n * mybricks@126.com\n */\n/**\n * MyBricks Opensource\n * https://mybricks.world\n * This source code is licensed under the MIT license.\n *\n * CheMingjun @2019\n * mybricks@126.com\n */\n.tb-fe27e {\n  position: relative;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  height: 170px;\n  background: #FFF;\n}\n.tb-fe27e .llmIcon-f1353 {\n  position: absolute;\n  top: 6px;\n  left: 5px;\n}\n.tb-fe27e .llmIcon-f1353 svg {\n  height: 12px;\n  width: 12px;\n}\n.tb-fe27e .llmIcon-f1353 svg path {\n  fill: var(--role-color);\n}\n.tb-fe27e .curAttach-c2cd0 {\n  position: absolute;\n  top: 28px;\n  left: 15px;\n  display: flex;\n  justify-content: flex-start;\n}\n.tb-fe27e .curAttach-c2cd0 .showImg-eace0 {\n  position: absolute;\n  right: calc(100% + 10px);\n  bottom: 0;\n  background: #DDD;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 1000;\n  width: 300px;\n  height: 300px;\n  border: 1px solid #DDD;\n  border-radius: 5px;\n  padding: 5px;\n}\n.tb-fe27e .curAttach-c2cd0 .showImg-eace0 img {\n  max-width: 100%;\n  max-height: 100%;\n  border: 1px solid #FFF;\n  border-radius: 5px;\n}\n.tb-fe27e .curAttach-c2cd0 img {\n  max-width: 120px;\n  max-height: 20px;\n  border: 1px solid #CCC;\n  padding: 2px;\n}\n.tb-fe27e .curAttach-c2cd0 label {\n  color: #999;\n  font-size: 11px;\n  margin-left: 5px;\n  margin-top: -3px;\n  line-height: 11px;\n}\n.tb-fe27e .curAttach-c2cd0 span {\n  position: absolute;\n  top: 10px;\n  left: -5px;\n  background: red;\n  width: 12px;\n  height: 12px;\n  border-radius: 14px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n}\n.tb-fe27e .curAttach-c2cd0 span svg {\n  max-width: 10px;\n}\n.tb-fe27e .curAttach-c2cd0 span svg path {\n  fill: #FFF;\n}\n.tb-fe27e textarea {\n  position: absolute;\n  top: 25px;\n  left: 5px;\n  right: 5px;\n  bottom: 15px;\n  padding: 5px 8px;\n  resize: none;\n  box-sizing: border-box;\n  background: #F7F7F7;\n  border-radius: 5px;\n}\n.tb-fe27e textarea::placeholder {\n  color: #999;\n  font-size: 11px;\n}\n.tb-fe27e textarea::selection {\n  background: #000;\n}\n.tb-fe27e .submit-ad0f6 {\n  position: absolute;\n  bottom: 5px;\n  right: 5px;\n  width: 22px;\n  height: 22px;\n  border-radius: 22px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n  background: var(--role-color);\n  box-shadow: 0 2px 4px 2px rgba(39, 54, 78, 0.2);\n}\n.tb-fe27e .submit-ad0f6 svg {\n  position: static;\n  width: 10px;\n  height: 10px;\n}\n.tb-fe27e .submit-ad0f6 svg path {\n  fill: #FFF;\n}\n.tb-fe27e .files-ccda9 {\n  cursor: pointer;\n  position: absolute;\n  left: 10px;\n  bottom: 5px;\n  width: 24px;\n  height: 22px;\n  background: #FFF;\n  border: 1px solid #DDD;\n  border-radius: 5px;\n  z-index: 100;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  box-shadow: 0 2px 4px 2px rgba(39, 54, 78, 0.1);\n}\n.tb-fe27e .files-ccda9 svg {\n  width: 13px;\n  height: 13px;\n}\n.tb-fe27e .files-ccda9 svg path {\n  fill: #777;\n}\n.tb-fe27e .files-ccda9 input {\n  position: absolute;\n  width: 1px;\n  height: 1px;\n  padding: 0;\n  margin: -1px;\n  overflow: hidden;\n  clip: rect(0, 0, 0, 0);\n  white-space: nowrap;\n  border-width: 0;\n}\n.tb-fe27e .llmIng-bde7d {\n  color: #AAA;\n  font-style: italic;\n  position: absolute;\n  left: 0;\n  top: 1px;\n  right: 0;\n  bottom: 0;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n}\n.tb-fe27e .llmIng-bde7d label {\n  position: absolute;\n  left: 20px;\n  top: 3px;\n}\n.tb-fe27e .llmIng-bde7d label span {\n  color: var(--role-color);\n  font-style: normal;\n  font-size: 10px;\n  margin-right: 5px;\n}\n.tb-fe27e .llmIng-bde7d .loader-fc942 {\n  width: 25px;\n  height: 25px;\n  aspect-ratio: 1;\n  border-radius: 25px;\n  border: 4px solid #DDD;\n  border-right-color: var(--role-color);\n  animation: l2-ac167 1s infinite linear;\n}\n.tb-fe27e .llmIng-bde7d p {\n  margin-top: 5px;\n  color: #AAA;\n  font-size: 10px;\n}\n@keyframes l2-ac167 {\n  to {\n    transform: rotate(1turn);\n  }\n}\n.tb-fe27e .llmConfirm-c4c36 {\n  color: #AAA;\n  font-style: italic;\n  position: absolute;\n  left: 0;\n  top: 1px;\n  right: 0;\n  bottom: 0;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n}\n.tb-fe27e .llmConfirm-c4c36 label {\n  position: absolute;\n  left: 20px;\n  top: 3px;\n  z-index: 1;\n}\n.tb-fe27e .llmConfirm-c4c36 label span {\n  color: var(--role-color);\n  font-style: normal;\n  font-size: 10px;\n  margin-right: 5px;\n}\n.tb-fe27e .llmConfirm-c4c36 .loader-fc942 {\n  width: 25px;\n  height: 25px;\n  aspect-ratio: 1;\n  border-radius: 25px;\n  border: 4px solid #DDD;\n  border-right-color: var(--role-color);\n  animation: l2-ac167 1s infinite linear;\n}\n.tb-fe27e .llmConfirm-c4c36 p {\n  font-size: 11px;\n  margin-bottom: 5px;\n  color: #AAA;\n}\n.tb-fe27e .llmConfirm-c4c36 .btns-f27f8 {\n  display: flex;\n  flex-direction: column;\n  gap: 5px;\n  width: 80%;\n}\n.tb-fe27e .llmConfirm-c4c36 .btns-f27f8 button {\n  border-radius: 5px;\n  pointer-events: auto;\n  cursor: pointer;\n  padding: 0 15px;\n  height: 25px;\n  font-style: normal;\n  font-size: 12px;\n}\n.tb-fe27e .llmConfirm-c4c36 .btns-f27f8 .btnApply-f7b5c {\n  color: #0a7c05;\n  font-weight: bold;\n  border: 1px solid #0a7c05;\n  background: #FFF;\n}\n.tb-fe27e .llmConfirm-c4c36 .btns-f27f8 .btnApply-f7b5c:hover {\n  background: #f2fbf2;\n}\n.tb-fe27e .llmConfirm-c4c36 .btns-f27f8 .btnCancel-db847 {\n  color: red;\n  border: 1px solid red;\n}\n.tb-fe27e .llmConfirm-c4c36 .btns-f27f8 .btnCancel-db847:hover {\n  background: #f8ecec;\n}\n.tb-fe27e .llmConfirm-c4c36 .btns-f27f8 .btnTryAgain-c531d {\n  border: 1px solid #f1a10b;\n  font-weight: bold;\n  color: #f8a300;\n  background: #FFF;\n}\n.tb-fe27e .llmConfirm-c4c36 .btns-f27f8 .btnTryAgain-c531d:hover {\n  background: #fffbf4;\n}\n@keyframes l2-ac167 {\n  to {\n    transform: rotate(1turn);\n  }\n}\n.tb-fe27e .onError-e07db {\n  position: absolute;\n  left: 0;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  display: flex;\n  flex-direction: column;\n  padding: 3px 0 0 20px;\n}\n.tb-fe27e .onError-e07db p {\n  font-style: italic;\n  font-size: 11px;\n  color: #FF0000;\n  display: flex;\n  overflow: auto;\n  flex-direction: column;\n}\n.tb-fe27e .onError-e07db > div {\n  display: flex;\n  margin-top: auto;\n  margin-left: auto;\n}\n.tb-fe27e .onError-e07db > div button {\n  font-size: 12px;\n  height: 20px;\n  border: 1px solid #DDD;\n  border-radius: 5px;\n  margin: 5px;\n  padding: 0 15px;\n}\n.tb-fe27e .onError-e07db > div button:first-of-type {\n  background: var(--mybricks-color-primary, #FA6400);\n  color: #FFF;\n  font-weight: bold;\n  border-color: var(--mybricks-color-primary, #FA6400);\n}\n",""]),c.locals={tb:"tb-fe27e",llmIcon:"llmIcon-f1353",curAttach:"curAttach-c2cd0",showImg:"showImg-eace0",submit:"submit-ad0f6",files:"files-ccda9",llmIng:"llmIng-bde7d",loader:"loader-fc942",l2:"l2-ac167",llmConfirm:"llmConfirm-c4c36",btns:"btns-f27f8",btnApply:"btnApply-f7b5c",btnCancel:"btnCancel-db847",btnTryAgain:"btnTryAgain-c531d",onError:"onError-e07db"};const s=c},23639:(e,n,t)=>{t.d(n,{Z:()=>s});var r=t(37009),o=t.n(r),i=t(48814),c=t.n(i)()(o());c.push([e.id,'/**\n * MyBricks Opensource\n * https://mybricks.world\n * This source code is licensed under the MIT license.\n *\n * CheMingjun @2019\n * mybricks@126.com\n */\n/**\n * MyBricks Opensource\n * https://mybricks.world\n * This source code is licensed under the MIT license.\n *\n * CheMingjun @2019\n * mybricks@126.com\n */\n.preview-d89ad {\n  position: relative;\n  margin: 20px 5px 5px 5px;\n}\n.preview-d89ad .tt-ba976 {\n  position: absolute;\n  font-size: 12px;\n  color: #333;\n  width: 100%;\n  z-index: 1;\n}\n.preview-d89ad .tt-ba976 span {\n  position: absolute;\n  top: 0;\n  left: 0;\n  border-top-left-radius: 5px;\n  border-bottom-right-radius: 5px;\n  font-style: italic;\n  pointer-events: none;\n  padding: 0 8px;\n  color: #FFF;\n  font-size: 10px;\n}\n.preview-d89ad .tt-ba976 label {\n  position: absolute;\n  right: 5px;\n  top: 4px;\n  background: #BBB;\n  padding: 1px 5px;\n  line-height: 12px;\n  border-radius: 3px;\n  font-size: 11px;\n  color: #FFF;\n}\n.preview-d89ad .content-e1c23 {\n  position: relative;\n  height: 70px;\n  border-radius: 5px;\n  background: #FFF;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 0 15px;\n  overflow: hidden;\n  box-shadow: 0 1px 4px -1px #BBB;\n}\n.preview-d89ad .content-e1c23:hover {\n  box-shadow: 0 1px 8px -1px #777;\n}\n.preview-d89ad .content-e1c23:hover button {\n  visibility: visible;\n}\n.preview-d89ad .content-e1c23 label {\n  color: #333;\n  font-weight: bold;\n}\n.preview-d89ad .content-e1c23 button {\n  visibility: hidden;\n  cursor: pointer;\n  font-weight: bold;\n  border-radius: 5px;\n  padding: 3px 12px;\n}\n.preview-d89ad .content-e1c23 .btnPreview-a843c {\n  margin-left: auto;\n  background: var(--mybricks-color-primary, #FA6400);\n  color: #FFF;\n}\n.preview-d89ad .content-e1c23 .btnApply-fd7a8 {\n  margin-left: 10px;\n  color: #333;\n  background: #FFF;\n  border: 1px solid #DDD;\n}\n.confirm-a3847 .tt-ba976 label {\n  color: #FFF;\n  left: 6px;\n  right: auto;\n  top: 4px;\n  background: transparent;\n}\n.confirm-a3847 .content-e1c23 {\n  font-weight: bold;\n  background: var(--mybricks-color-primary, #FA6400);\n}\n.confirm-a3847 .content-e1c23 label {\n  color: #FFF;\n}\n.confirm-a3847 .content-e1c23 .btnPreview-a843c {\n  background: #FFF;\n  color: var(--mybricks-color-primary, #FA6400);\n  visibility: visible;\n}\n.used-f495d {\n  border-color: #4c914a;\n}\n.used-f495d span {\n  background: #4c914a;\n}\n.unused-c16e9 {\n  border-color: #BBB;\n}\n.unused-c16e9 span {\n  background: #999;\n}\n.popup-c34e2 {\n  position: absolute;\n  z-index: 100000;\n  background: rgba(255, 255, 255, 0.8);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  left: 0;\n  top: 0;\n  width: 100%;\n  height: 100%;\n}\n.popup-c34e2 > div {\n  position: relative;\n  width: 70%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: #FFF;\n  box-shadow: 0 0 5px 1px rgba(39, 54, 78, 0.15);\n}\n.popup-c34e2 > div > .toolbar-c24af {\n  position: absolute;\n  left: 50%;\n  transform: translateX(-50%);\n  bottom: -50px;\n  width: fit-content;\n  height: 40px;\n  overflow: hidden;\n  display: flex;\n  align-items: center;\n  background: #FFF;\n  border: 1px solid #DDD;\n  padding: 0 10px;\n  border-radius: 5px;\n}\n.popup-c34e2 > div > .toolbar-c24af .ver-e9ea9 {\n  color: #333;\n  padding: 0 10px;\n  font-size: 12px;\n  width: fit-content;\n  height: 22px;\n  background: #DDD;\n  border-radius: 5px;\n  line-height: 22px;\n}\n.popup-c34e2 > div > .toolbar-c24af .showSelector-e0666 {\n  margin-left: 8px;\n}\n.popup-c34e2 > div > .toolbar-c24af .showSelector-e0666 label {\n  cursor: pointer;\n  position: relative;\n  display: inline-block;\n  padding: 2px 12px 0 22px;\n  height: 22px;\n  background-color: #999;\n  border-color: #999;\n  color: #FFF;\n  font-size: 12px;\n  border-radius: 15px;\n}\n.popup-c34e2 > div > .toolbar-c24af .showSelector-e0666 label::before {\n  content: " ";\n  display: inline-block;\n  width: 14px;\n  height: 14px;\n  border-radius: 50%;\n  position: absolute;\n  left: 3px;\n  top: 4px;\n  background-color: #fff;\n  transition: all 0.4s ease;\n  cursor: pointer;\n}\n.popup-c34e2 > div > .toolbar-c24af .checked-e2cc6 label {\n  padding: 2px 22px 0 12px !important;\n  background-color: var(--mybricks-color-primary, #FA6400) !important;\n  border-color: var(--mybricks-color-primary, #FA6400) !important;\n}\n.popup-c34e2 > div > .toolbar-c24af .checked-e2cc6 label::before {\n  left: auto !important;\n  right: 3px !important;\n}\n.popup-c34e2 > div > .resizer-f5856 {\n  user-select: none;\n  position: absolute;\n  right: -18px;\n  bottom: -18px;\n  width: 20px;\n  height: 20px;\n  /* background: #FFF; */\n  border-right: 5px solid var(--mybricks-color-primary, #FA6400);\n  border-bottom: 5px solid var(--mybricks-color-primary, #FA6400);\n  cursor: se-resize;\n}\n.popup-c34e2 > div > .close-b3ad3 {\n  position: absolute;\n  right: -30px;\n  top: -30px;\n  width: 22px;\n  height: 22px;\n  border-radius: 22px;\n  background: var(--mybricks-color-primary, #FA6400);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n}\n.popup-c34e2 > div > .close-b3ad3 svg {\n  max-width: 14px;\n}\n.popup-c34e2 > div > .close-b3ad3 svg path {\n  fill: #FFF;\n}\n.popup-c34e2 > div .content-e1c23 {\n  width: 100%;\n  height: 100%;\n  overflow: auto;\n}\n.popup-c34e2 > div .content-e1c23 > * {\n  width: 100%;\n  height: 100%;\n}\n.popup-c34e2 > div .content-e1c23 > * [data-temp-com=slot] {\n  border: 1px dashed #DDD;\n  color: #AAA;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 12px;\n  font-style: italic;\n  font-weight: 200;\n}\n.popup-c34e2 > div .content-e1c23 > * [data-ai-zone-selector] {\n  position: relative;\n  outline: 1px dashed var(--mybricks-color-primary, #FA6400);\n  outline-offset: -1px;\n}\n.popup-c34e2 > div .content-e1c23 > * [data-ai-zone-selector]:before {\n  content: "";\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(244, 132, 132, 0.46);\n}\n',""]),c.locals={preview:"preview-d89ad",tt:"tt-ba976",content:"content-e1c23",btnPreview:"btnPreview-a843c",btnApply:"btnApply-fd7a8",confirm:"confirm-a3847",used:"used-f495d",unused:"unused-c16e9",popup:"popup-c34e2",toolbar:"toolbar-c24af",ver:"ver-e9ea9",showSelector:"showSelector-e0666",checked:"checked-e2cc6",resizer:"resizer-f5856",close:"close-b3ad3"};const s=c},8150:(e,n,t)=>{t.d(n,{Z:()=>s});var r=t(37009),o=t.n(r),i=t(48814),c=t.n(i)()(o());c.push([e.id,"/**\n * MyBricks Opensource\n * https://mybricks.world\n * This source code is licensed under the MIT license.\n *\n * CheMingjun @2019\n * mybricks@126.com\n */\n/**\n * MyBricks Opensource\n * https://mybricks.world\n * This source code is licensed under the MIT license.\n *\n * CheMingjun @2019\n * mybricks@126.com\n */\n.icon-f61c6 {\n  z-index: 1000;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  position: absolute;\n  bottom: 5px;\n  right: 10px;\n  width: 30px;\n  height: 30px;\n  background: var(--mybricks-color-primary, #FA6400);\n  border-radius: 30px;\n  box-shadow: 0 3px 5px 2px rgba(39, 54, 78, 0.35);\n  animation: pop-a2005 0.7s;\n  color: #FFF;\n  font-size: 12px;\n  font-weight: bold;\n}\n.icon-f61c6 span {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n@keyframes positionChange-f3d33 {\n  0% {\n    background-position-x: 0%;\n  }\n  100% {\n    background-position-x: 100%;\n  }\n}\n.icon-f61c6 svg {\n  max-width: 25px;\n}\n.icon-f61c6 svg path {\n  fill: #FFF;\n}\n@keyframes pop-a2005 {\n  0% {\n    bottom: -10px;\n  }\n  20% {\n    bottom: 20px;\n  }\n  50% {\n    bottom: 10px;\n  }\n  75% {\n    bottom: 5px;\n  }\n  100% {\n    bottom: 5px;\n  }\n}\n.view-b20ee {\n  position: relative;\n  z-index: 1000;\n  display: flex;\n  flex-direction: column;\n  margin: 8px;\n  padding: 3px;\n  border-radius: 6px;\n  background: radial-gradient(var(--mybricks-color-primary, #FA6400) 0%, var(--mybricks-color-primary, #FA6400) 10%, #00eef4 40%, #7539be 60%, #d519d2 70%, var(--mybricks-color-primary, #FA6400) 100%);\n  animation: shining-e3420 20s linear infinite;\n  will-change: background-position;\n  background-size: 300% 300%;\n  box-shadow: 0 -3px 15px 0px rgba(167, 79, 198, 0.2);\n}\n.view-b20ee .curScene-ca949 {\n  padding: 0 0 0 7px;\n  margin: 1px 0 1px 0;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  background: rgba(255, 255, 255, 0.2);\n  height: 22px;\n}\n.view-b20ee .curScene-ca949 span {\n  font-style: italic;\n  font-weight: normal;\n  color: #EEE;\n  margin-right: 10px;\n}\n.view-b20ee .curScene-ca949 label {\n  font-weight: bold;\n  flex: 1;\n  color: #FFF;\n}\n.view-b20ee .curScene-ca949 select {\n  color: #AAA;\n  text-align: right;\n  margin-right: 8px;\n  font-style: italic;\n}\n.view-b20ee .curScene-ca949 .iconClear-e7381,\n.view-b20ee .curScene-ca949 .iconMini-dd056 {\n  height: 14px;\n  cursor: pointer;\n}\n.view-b20ee .curScene-ca949 .iconClear-e7381 svg,\n.view-b20ee .curScene-ca949 .iconMini-dd056 svg {\n  max-height: 11px;\n  max-width: 11px;\n}\n.view-b20ee .curScene-ca949 .iconClear-e7381 svg path,\n.view-b20ee .curScene-ca949 .iconMini-dd056 svg path {\n  fill: #FFF;\n}\n.view-b20ee .curScene-ca949 .iconMini-dd056 {\n  margin-left: 5px;\n}\n.view-b20ee .running-bb2a7 .iconClear-e7381,\n.view-b20ee .running-bb2a7 .iconMini-dd056 {\n  opacity: 0.2;\n  pointer-events: none;\n}\n.view-b20ee .content-db4d5 {\n  flex: 1;\n  padding: 5px 5px;\n  max-height: 300px;\n  overflow: auto;\n  background-color: #FBFBFB;\n}\n.view-b20ee .content-db4d5:empty {\n  padding: 0 !important;\n  margin-top: -1px;\n}\n.view-b20ee .content-db4d5 .request-f3246 {\n  padding: 20px 5px 0 5px;\n  position: relative;\n  user-select: text;\n  word-break: break-all;\n  margin-top: 20px;\n  border-top: 1px dashed #DDD;\n}\n.view-b20ee .content-db4d5 .request-f3246:before {\n  content: '我：';\n  color: #999;\n  font-size: 12px;\n  font-style: italic;\n}\n.view-b20ee .content-db4d5 .request-f3246:first-child {\n  padding-top: 0;\n  margin-top: 0;\n  border-top: none;\n}\n.view-b20ee .content-db4d5 .request-f3246 label {\n  color: #777;\n  margin-right: 3px;\n  font-size: 10px;\n}\n.view-b20ee .content-db4d5 .request-f3246 span {\n  color: #333;\n}\n.view-b20ee .content-db4d5 .response-d799a {\n  padding: 0 5px 5px 5px;\n  position: relative;\n  user-select: text;\n  text-align: right;\n  margin-bottom: 10px;\n  border-bottom: 1px dashed #DDD;\n}\n.view-b20ee .content-db4d5 .response-d799a:last-of-type {\n  border-bottom: none !important;\n  margin-bottom: 0 !important;\n}\n.view-b20ee .content-db4d5 .response-d799a:after {\n  content: ':AI';\n  color: #999;\n  font-style: italic;\n  margin-left: 3px;\n}\n.view-b20ee .content-db4d5 .loading-e3279 {\n  color: #FF0000;\n  font-size: 10px;\n  font-style: italic;\n  margin-left: 3px;\n}\n.view-b20ee .content-db4d5 .ing-b7cb1 {\n  color: #1268c8;\n}\n.view-b20ee .content-db4d5 .done-c96e7,\n.view-b20ee .content-db4d5 .apiDone-d2442 {\n  padding-top: 5px;\n  color: #0a7c05;\n  font-size: 12px;\n  margin-left: 3px;\n  line-height: 18px;\n  user-select: text;\n}\n.view-b20ee .content-db4d5 .done-c96e7:before,\n.view-b20ee .content-db4d5 .apiDone-d2442:before {\n  content: attr(data-role-title) '：';\n  color: #999;\n  font-size: 12px;\n  font-style: italic;\n}\n.view-b20ee .content-db4d5 .done-c96e7 span,\n.view-b20ee .content-db4d5 .apiDone-d2442 span {\n  display: inline-block;\n  width: 5px;\n}\n.view-b20ee .content-db4d5 pre {\n  background: #F3F3F3;\n  padding: 5px 8px;\n  border-radius: 5px;\n  color: #222;\n  direction: ltr;\n  position: relative;\n  height: 32px;\n  overflow: hidden;\n}\n.view-b20ee .content-db4d5 pre:first-of-type {\n  margin-top: 5px;\n}\n.view-b20ee .content-db4d5 pre:hover [data-code-btn] {\n  opacity: 1;\n}\n.view-b20ee .content-db4d5 pre label {\n  font-style: italic;\n  color: #999;\n  margin-left: 3px;\n  margin-top: 2px;\n  margin-bottom: -22px;\n  display: flex;\n}\n.view-b20ee .content-db4d5 pre [data-code-btn] {\n  position: absolute;\n  right: 8px;\n  top: 5px;\n  background: #FFF;\n  padding: 1px 8px;\n  border-radius: 5px;\n  border: 1px solid #CCC;\n  font-size: 11px;\n  cursor: pointer;\n  opacity: 0.3;\n}\n.view-b20ee .content-db4d5 pre code {\n  display: none;\n  margin: 0;\n  padding-left: 5px;\n  text-wrap: auto;\n}\n.view-b20ee .content-db4d5 div[data-type=\"load\"] {\n  display: inline-flex;\n  background: #FFF;\n  border: 1px solid #AAA;\n  padding: 0 6px;\n  margin: 0 5px;\n  border-radius: 5px;\n  color: #777;\n  font-style: italic;\n  width: fit-content;\n  font-size: 10px;\n}\n.view-b20ee .content-db4d5 div[data-type=\"cmd\"] {\n  background: #e6f3df;\n  border: 1px solid #b0d6aa;\n  margin-top: 7px;\n  padding: 0 8px;\n  border-radius: 5px;\n  color: #999;\n  font-style: italic;\n  width: fit-content;\n  font-size: 10px;\n}\n.view-b20ee .content-db4d5 .error-ca63e {\n  color: #d36c2c;\n  font-size: 10px;\n  font-style: italic;\n  margin-left: 3px;\n}\n.view-b20ee .content-db4d5 .resDone-f4928 {\n  color: #0a7c05;\n}\n.view-b20ee .content-db4d5 .resError-a9740 {\n  color: red;\n}\n.view-b20ee .execute-cd333 button {\n  background: var(--mybricks-color-primary, #FA6400);\n  border-radius: 3px;\n  padding: 1px 5px;\n  margin-bottom: 5px;\n  cursor: pointer;\n  color: #FFF;\n  font-weight: bold;\n}\n.disabled-a6bc8 {\n  background: #AAA;\n  animation: none;\n  box-shadow: none;\n}\n.disabled-a6bc8 textarea {\n  pointer-events: none;\n  color: #AAA;\n}\n.error-ca63e {\n  background: #FF0000;\n  animation: none;\n  box-shadow: none;\n}\n.error-ca63e textarea {\n  pointer-events: none;\n  color: #AAA;\n}\n@keyframes shining-e3420 {\n  0% {\n    background-position: -20% -20%;\n  }\n  25% {\n    background-position: 30% 80%;\n  }\n  50% {\n    background-position: 110% 110%;\n  }\n  75% {\n    background-position: 80% 30%;\n  }\n  to {\n    background-position: -20% -20%;\n  }\n}\n",""]),c.locals={icon:"icon-f61c6",pop:"pop-a2005",view:"view-b20ee",shining:"shining-e3420",curScene:"curScene-ca949",iconClear:"iconClear-e7381",iconMini:"iconMini-dd056",running:"running-bb2a7",content:"content-db4d5",request:"request-f3246",response:"response-d799a",loading:"loading-e3279",ing:"ing-b7cb1",done:"done-c96e7",apiDone:"apiDone-d2442",error:"error-ca63e",resDone:"resDone-f4928",resError:"resError-a9740",execute:"execute-cd333",disabled:"disabled-a6bc8",positionChange:"positionChange-f3d33"};const s=c},87465:(e,n,t)=>{t.d(n,{Z:()=>h});var r=t(93379),o=t.n(r),i=t(7795),c=t.n(i),s=t(90569),a=t.n(s),l=t(3565),d=t.n(l),p=t(19216),u=t.n(p),b=t(44589),m=t.n(b),f=t(13985),g={};g.styleTagTransform=m(),g.setAttributes=d(),g.insert=a().bind(null,"head"),g.domAPI=c(),g.insertStyleElement=u();o()(f.Z,g);const h=f.Z&&f.Z.locals?f.Z.locals:void 0},86784:(e,n,t)=>{t.d(n,{Z:()=>h});var r=t(93379),o=t.n(r),i=t(7795),c=t.n(i),s=t(90569),a=t.n(s),l=t(3565),d=t.n(l),p=t(19216),u=t.n(p),b=t(44589),m=t.n(b),f=t(86229),g={};g.styleTagTransform=m(),g.setAttributes=d(),g.insert=a().bind(null,"head"),g.domAPI=c(),g.insertStyleElement=u();o()(f.Z,g);const h=f.Z&&f.Z.locals?f.Z.locals:void 0},36525:(e,n,t)=>{t.d(n,{Z:()=>h});var r=t(93379),o=t.n(r),i=t(7795),c=t.n(i),s=t(90569),a=t.n(s),l=t(3565),d=t.n(l),p=t(19216),u=t.n(p),b=t(44589),m=t.n(b),f=t(23639),g={};g.styleTagTransform=m(),g.setAttributes=d(),g.insert=a().bind(null,"head"),g.domAPI=c(),g.insertStyleElement=u();o()(f.Z,g);const h=f.Z&&f.Z.locals?f.Z.locals:void 0},22896:(e,n,t)=>{t.d(n,{Z:()=>h});var r=t(93379),o=t.n(r),i=t(7795),c=t.n(i),s=t(90569),a=t.n(s),l=t(3565),d=t.n(l),p=t(19216),u=t.n(p),b=t(44589),m=t.n(b),f=t(8150),g={};g.styleTagTransform=m(),g.setAttributes=d(),g.insert=a().bind(null,"head"),g.domAPI=c(),g.insertStyleElement=u();o()(f.Z,g);const h=f.Z&&f.Z.locals?f.Z.locals:void 0},98228:(e,n,t)=>{t.d(n,{Z:()=>s});var r=t(83446),o=t(6031),i=function(e,n,t,r){var o,i=arguments.length,c=i<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,t):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,n,t,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(c=(i<3?o(c):i>3?o(n,t,c):o(n,t))||c);return i>3&&c&&Object.defineProperty(n,t,c),c},c=function(e,n){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,n)};class s{constructor(){this.scenes={},this.actived=!1,this.messages={},this.curUserMessages={},this.responses={},this.loading=!1}focusTextarea(){this.textEl.focus()}setCurRole(e){this.curRole=e,this.curUserMessages[e.id]=[],this.scenes[this.curScene.id]={curRoleId:e.id}}setCurScene(e){var n;if(this.curScene&&this.curScene.id===e.id)return;this.curRoles=void 0,this.curScene=e,e.active?(this.actived=!0,setTimeout((e=>{this.scrollContent()}))):this.actived=!1;const t=e.id,r=e.getRoles;if("function"==typeof r){const e=r();if(Array.isArray(e)&&e.length>0){this.curRoles=e;const r=null===(n=this.scenes[t])||void 0===n?void 0:n.curRoleId;r?this.setCurRole(e.find((e=>e.id===r))):this.setCurRole(e[0])}}t&&(t in this.messages||(this.messages[this.curScene.id]={}),t in this.responses||(this.responses[this.curScene.id]={}))}isRunning(){var e;return"ing"===(null===(e=this.curScene)||void 0===e?void 0:e.status)}isConfirming(){var e;return"confirm"===(null===(e=this.curScene)||void 0===e?void 0:e.status)}getCurMessageAry(e){return this.messages[this.curScene.id][e.id]}syncMessage(e,n){const t=this.messages[this.curScene.id];if(t)for(let r in t)r!==e.id&&t[r].push(n)}applyMessage(e){const n=this.responses[this.curScene.id][this.curRole.id];n&&n.forEach(((t,r)=>{if(t.id===e){r<n.length-1&&n.splice(r+1)}}))}appendMessage(e,n){const t=this.messages[this.curScene.id];let r=t[e];r||(r=t[e]=[]),r.push(n)}getCurResponseAry(){const e=this.responses[this.curScene.id];let n=e[this.curRole.id];return n||(n=e[this.curRole.id]=[]),n}getLLMIcon(){return o.My}scrollContent(){this.contentEl&&(this.contentEl.scrollTop=this.contentEl.scrollHeight)}request(e){const{role:n,reqRole:t,aiRole:r,question:o,attachments:i,getStartAIRole:c,getSystemPrompts:s,getPromptAppended:a,getTools:l,emits:d}=e,p=this.context.configs.aiView;let u,b;if("function"==typeof p.requestAsStream?u=p.requestAsStream:"function"==typeof p.request&&(b=p.request),"function"==typeof u||"function"==typeof b){const e=this.messages[this.curScene.id];let p=e[n.id];p||(p=e[n.id]=[]);const m=a();let f=r;if(0===p.length){f||(f=c());const e=s(n.id,{question:o,attachments:i});p.push({role:"system",content:e})}else{const e=s(n.id,{question:o,attachments:i}),t=p[0];"system"===t.role&&t.content!==e&&(t.content=e)}if(m&&p.push({role:"user",content:m}),o){const e={role:t,content:o};i&&(f="image",e.content=[{type:"text",text:o},{type:"image_url",image_url:{url:i.base64}}]),p.push(e),this.curUserMessages[this.curRole.id].push(o)}const g=l();if("function"==typeof u)return u(p,g,d,{aiRole:f});"function"==typeof b&&b(p,f).then((e=>{d.write(e),d.complete()})).catch((e=>{this.setError(e),d.error(e)}))}}setError(e){this.errMsg=e.message,this.curResponseOri=void 0}setTryAgain(e,n){this.errTryAgain={role:e,errorMsg:n}}clearTryAgain(){this.errTryAgain=void 0}active(){this.actived=!0}minimize(){this.actived=!1}clear(){this.curScene=void 0}clearMessages(){this.messages={},this.curScene&&(this.messages[this.curScene.id]={},this.responses[this.curScene.id]=[])}}i([r.jj,c("design:type",Object)],s.prototype,"curModel",void 0)},59551:(e,n,t)=>{t.d(n,{Z:()=>l});var r=t(90359),o=t(22896),i=t(79127),c=t(83446),s=t(57720),a=t(90359);function l({ctx:e}){var n;const t=e.curScene;return(0,c.CV)(i.cA.Logs,(n=>n({error(n,t,r){var o,i;e.actived&&r&&e&&(null===(o=r.model)||void 0===o?void 0:o.id)===(null===(i=e.curScene)||void 0===i?void 0:i.id)&&e.setTryAgain("_default",t)}})),{from:"parents"}),(0,r.useEffect)((()=>{var n;"done"===(null===(n=e.curScene)||void 0===n?void 0:n.status)&&setTimeout((n=>{e.textEl.select(),e.textEl.focus()}),1e3)}),[e.textEl,e.actived,null===(n=e.curScene)||void 0===n?void 0:n.status]),e.actived?a.createElement(s.Z,{ctx:e}):t?a.createElement("div",{className:o.Z.icon,onClick:e.active},a.createElement("span",null,"AI")):void 0}},6031:(e,n,t)=>{t.d(n,{My:()=>o,Pg:()=>c,k4:()=>i});var r=t(90359);r.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16"},r.createElement("path",{d:"M348.36 355.61a36 36 0 0 0-36 36v254.54a36 36 0 0 0 72 0V391.61a36 36 0 0 0-36-36zM737.21 367.55a36 36 0 0 0-50.84-2.72L544.71 492.1a36 36 0 0 0 0.64 54.12L687 667.63A36 36 0 1 0 733.86 613l-110.51-94.76 111.14-99.85a36 36 0 0 0 2.72-50.84z",fill:"#515151"}),r.createElement("path",{d:"M910 228.46c-26.1-22.88-61.73-43.81-105.91-62.2-41.66-17.34-89.85-31.72-139.36-41.6A788.76 788.76 0 0 0 511 109c-83.82 0-191.07 21.85-279.88 57-46.8 18.53-84.7 39.15-112.66 61.27-36.63 29-55.21 60.18-55.21 92.7V701c0 72.36 91.14 123.41 167.6 153.5 88.57 34.85 196 56.5 280.4 56.5 76.07 0 182.87-21.5 272.11-54.77 48.54-18.1 87.86-38.07 116.89-59.36 39.15-28.73 59-60 59-92.87V320c0-32.08-16.57-62.88-49.25-91.54zM887.25 704c0 6-7.75 18.79-29.6 34.82-23.33 17.12-57.72 34.39-99.44 49.95-80.59 30-179.83 50.23-247 50.23-76 0-173.31-19.73-254-51.5-89.48-35.21-122-71-122-86.5V320c0-15.5 32.59-51.47 122.38-87 79.75-31.6 179.2-52 253.41-52 88.36 0 187.58 19.34 265.42 51.74 76.15 31.69 110.83 67.45 110.83 87.26z",fill:"#515151"}));const o=r.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16"},r.createElement("path",{d:"M512 1024C229.052632 1024 0 794.947368 0 512S229.052632 0 512 0s512 229.052632 512 512c0 116.77193-40.421053 231.298246-114.526316 321.122807L875.789474 806.175439c67.368421-83.087719 103.298246-186.385965 103.298245-294.175439C979.087719 253.754386 770.245614 44.912281 512 44.912281S44.912281 253.754386 44.912281 512s208.842105 467.087719 467.087719 467.087719c60.631579 0 116.77193-11.22807 172.912281-33.68421l15.719298 42.666666c-58.385965 24.701754-123.508772 35.929825-188.631579 35.929825z",fill:"#515151"}),r.createElement("path",{d:"M714.105263 761.263158V455.859649c0-24.701754 2.245614-56.140351 4.491228-89.824561h-2.245614c-6.736842 22.45614-11.22807 38.175439-15.719298 47.157894L529.964912 763.508772H494.035088l-170.666667-348.070176c-4.491228-8.982456-8.982456-24.701754-15.719298-49.403508h-2.245614c2.245614 22.45614 2.245614 51.649123 2.245614 94.315789V763.508772h-65.122807V300.912281h89.824561l152.701755 316.631579c11.22807 24.701754 20.210526 42.666667 22.45614 56.140351h2.245614c11.22807-29.192982 20.210526-47.157895 24.701754-58.385965l154.947369-314.385965h87.578947v460.350877h-62.877193z",fill:"#515151"})),i=(r.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32"},r.createElement("path",{d:"M939.7888 421.4144a248.832 248.832 0 0 0-21.376-204.3904 251.6608 251.6608 0 0 0-271.0656-120.7424A248.832 248.832 0 0 0 459.648 12.608a251.6864 251.6864 0 0 0-240.0896 174.2592 248.9216 248.9216 0 0 0-166.4 120.704 251.6992 251.6992 0 0 0 30.9504 295.1168 248.832 248.832 0 0 0 21.3888 204.3904 251.6864 251.6864 0 0 0 271.0656 120.7424 248.832 248.832 0 0 0 187.6864 83.6736 251.6736 251.6736 0 0 0 240.1664-174.3488 248.9216 248.9216 0 0 0 166.4-120.7168 251.6992 251.6992 0 0 0-31.04-295.0144zM564.352 946.2016a186.6624 186.6624 0 0 1-119.8208-43.328c1.5104-0.832 4.1728-2.2784 5.9008-3.3536L649.3184 784.64a32.3328 32.3328 0 0 0 16.3328-28.288V475.9296l84.0704 48.5376a3.008 3.008 0 0 1 1.6384 2.304v232.2176a187.4304 187.4304 0 0 1-187.008 187.2z m-402.1888-171.776a186.5472 186.5472 0 0 1-22.336-125.44c1.472 0.8832 4.0576 2.4576 5.9008 3.52l198.8992 114.8928a32.3712 32.3712 0 0 0 32.6656 0l242.8288-140.2112v97.0752a3.008 3.008 0 0 1-1.2032 2.5856l-201.0496 116.0832a187.392 187.392 0 0 1-255.7056-68.5056zM109.824 340.224a186.5088 186.5088 0 0 1 97.4336-82.0736c0 1.7152-0.1024 4.736-0.1024 6.848v229.7728a32.32 32.32 0 0 0 16.3328 28.288l242.816 140.1856-84.0576 48.5376a3.008 3.008 0 0 1-2.8416 0.256L178.3296 595.84A187.392 187.392 0 0 1 109.824 340.224z m690.688 160.7296L557.696 360.7424l84.0576-48.512a3.008 3.008 0 0 1 2.8288-0.256l201.088 116.0832a187.2256 187.2256 0 0 1-28.928 337.8176V529.2416a32.3072 32.3072 0 0 0-16.2304-28.288z m83.6736-125.9264c-1.4848-0.9088-4.0576-2.4704-5.9136-3.5328l-198.8864-114.88a32.4096 32.4096 0 0 0-32.6656 0L403.8912 396.8256v-97.088a3.008 3.008 0 0 1 1.2032-2.5856l201.0496-115.9808a187.2128 187.2128 0 0 1 278.0416 193.856zM358.1824 548.0576l-84.096-48.5376a3.008 3.008 0 0 1-1.6256-2.304V264.9984a187.2128 187.2128 0 0 1 307.008-143.744 172.8 172.8 0 0 0-5.9136 3.3408l-198.8864 114.88a32.32 32.32 0 0 0-16.3456 28.288l-0.1408 280.2944z m45.6704-98.4576L512 387.136l108.16 62.4256v124.8896L512 636.8768l-108.16-62.4256v-124.8512z",fill:"#d81e06"})),r.createElement("svg",{viewBox:"0 0 1040 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16"},r.createElement("path",{d:"M367.632787 14.268852C360.918033 22.662295 327.344262 77.219672 293.770492 135.97377L231.659016 243.409836h-67.986885c-36.931148 0-71.344262 3.357377-76.380328 6.714754C77.219672 256.839344 0 387.777049 0 398.688525c0 4.196721 30.216393 58.754098 67.986885 123.383606L135.97377 637.901639l-30.216393 53.718033C88.970492 720.996721 75.540984 749.534426 75.540984 755.409836c0 5.036066 17.62623 39.44918 38.609836 75.540984l38.609836 67.147541h282.859016l26.859017 47.842623c41.967213 72.183607 49.521311 78.059016 110.793442 77.219672 111.632787-0.839344 107.436066 2.518033 181.298361-125.062295 66.308197-113.311475 66.308197-113.311475 100.721311-117.508197 27.698361-3.357377 36.931148-9.232787 47.003279-28.537705 6.714754-12.590164 12.590164-26.859016 12.590164-30.216393 0-4.196721 4.196721-17.62623 10.072131-31.055738 5.036066-12.590164 9.232787-26.019672 8.393443-30.216394-0.839344-3.357377 2.518033-5.87541 7.554098-5.875409 4.196721 0 5.87541-4.196721 3.357377-8.393443-2.518033-5.036066-20.983607-8.393443-40.288525-8.393443-35.252459 0-35.252459-0.839344-67.986885-58.754098-18.465574-32.734426-36.091803-56.236066-38.609836-52.878689-3.357377 4.196721-65.468852 110.793443-138.491803 237.534427-73.022951 126.740984-133.455738 231.659016-134.295082 233.337705-1.678689 1.678689-18.465574-26.019672-38.609836-60.432787l-36.931148-62.95082-140.170491-2.518033-140.170492-2.518033 35.252459-58.754098 35.252459-58.754098 68.826229-2.518033 67.986886-2.518033-133.455738-230.819672C168.708197 387.777049 109.114754 280.340984 109.114754 276.144262s31.055738-7.554098 69.665574-7.554098h68.826229l67.147541-117.508197c36.931148-64.629508 69.665574-117.508197 73.022951-117.508197C394.491803 33.57377 453.245902 137.652459 453.245902 150.242623c0 4.196721-13.429508 31.055738-29.37705 58.754098-15.947541 26.859016-29.377049 52.039344-29.377049 54.557377 0 2.518033 124.222951 5.87541 276.144263 6.714754l276.983606 2.518033-36.931147 59.593443-36.091804 60.432787 38.609836 67.986885c21.822951 36.931148 41.967213 67.986885 46.163935 67.986885 12.590164 0 5.036066-23.501639-27.698361-78.059016l-32.734426-57.07541 26.019672-43.645902c42.806557-73.022951 42.806557-72.183607 5.87541-145.206557-19.304918-36.931148-40.288525-71.344262-47.842623-77.219672-9.232787-6.714754-52.878689-10.072131-145.206557-10.072131H605.167213l-31.055738-52.878689c-16.786885-28.537705-34.413115-54.557377-40.288524-57.914754-5.036066-3.357377-41.967213-6.714754-81.416394-6.714754-58.754098 0-74.701639 2.518033-84.77377 14.268852z"}),r.createElement("path",{d:"M362.596721 426.386885C369.311475 444.013115 514.518033 688.262295 519.554098 691.619672c4.196721 3.357377 149.403279-237.534426 158.636066-264.393442 1.678689-4.196721-62.111475-7.554098-157.796721-7.554099-88.131148 0-159.47541 3.357377-157.796722 6.714754z"})),r.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16"},r.createElement("path",{d:"M96.20121136 636.3124965c-0.1472897-113.41305959-0.29457937-226.8261192-0.29457937-340.23917879 0-14.87625845 7.65906378-26.51214381 20.4732666-34.02391789 45.51251353-26.65943349 91.02502705-53.31886698 136.83211997-79.53643141 71.1409192-40.94653321 142.42912809-81.59848704 213.71733698-122.39773055 7.36448439-4.12411126 14.58167909-8.3955122 21.50429441-13.2560719 19.44223878-13.40336159 39.03176725-16.05457598 60.09419263-3.53495252 27.39588193 16.34915535 54.93905355 32.25644163 82.48222516 48.16372793 88.0792333 50.96223197 176.30575629 101.77717426 264.38498958 152.59211653 9.86840908 5.74429781 19.88410785 11.19401627 29.60522725 17.0856038 14.13981003 8.54280189 21.50429441 21.06242535 21.50429443 37.70616007 0 147.73155685 0.29457937 295.46311371-0.1472897 443.19467057 0 15.46541722-7.2171947 28.57419943-21.7988738 36.96971163-34.7603663 20.17868721-70.55176044 38.88447758-104.57567833 59.94690293-48.90017634 30.19438599-100.00969801 56.11737105-148.76258466 86.60633642-29.01606849 18.11663161-59.50503387 34.02391789-89.11026112 50.96223197-13.10878221 7.51177407-26.07027474 15.17083783-39.03176726 22.9771913-13.84523065 8.3955122-27.83775099 8.83738127-41.97756102 0.73644843-56.41195043-32.55102101-112.82390085-65.10204201-169.38314098-97.653063-61.86166887-35.64410444-123.72333775-71.1409192-185.4377169-106.78502365-11.19401627-6.48074626-22.24074286-12.81420285-32.99289009-19.88410785-11.48859565-7.65906378-17.08560379-19.14765941-17.08560378-32.69831069-0.1472897-34.7603663 0.1472897-69.52073264 0.29457938-104.28109895 1.62018657-0.58915875 1.62018657-1.62018657-0.29457938-2.65121438z m356.58833414-225.500512c2.20934532-1.76747625 4.41869063-3.68224221 6.77532565-5.15513907 68.93157389-39.62092601 137.86314777-79.24185204 206.94201135-118.86277807 2.79850407-1.62018657 6.48074626-1.62018657 6.62803594-6.18616688 0.1472897-4.8605597-4.12411126-4.71327001-6.77532564-6.18616688-40.65195383-23.56635005-81.59848704-46.83812071-122.10315117-70.84633984-16.79102442-10.01569877-32.84560039-8.54280189-48.45830728 0.58915876-45.9543826 26.51214381-91.46689612 53.61344636-137.27398903 80.42016953-31.96186226 18.70579035-64.21830387 37.11700133-96.32745581 55.67550198-18.41121097 10.60485751-27.54317163 25.33382629-27.24859225 47.72185885 0.88373813 89.55213018 0.58915875 179.10426036 0.14728969 268.65639053-0.1472897 20.17868721 9.27925033 33.58204881 25.33382629 43.15587853 31.3727035 18.70579035 63.18727606 37.11700133 95.14913832 54.93905355 10.89943689 6.03887719 21.06242535 13.99252034 35.79139414 18.41121096V505.51925374c6.48074626 19.58952848 18.55850066 34.02391789 36.67513226 44.6287754 27.83775099 16.20186565 63.18727606 12.51962347 86.31175705-10.45756784 26.95401286-26.65943349 28.72148912-62.89269668 12.81420282-90.14128893-16.34915535-28.42690974-43.59774757-37.55887038-74.38129233-38.73718787z m82.48222517 429.64401928c14.28709972-3.82953187 25.92298506-13.99252034 38.88447758-21.35700473 40.94653321-23.27177067 81.30390766-47.72185885 122.54502023-70.55176046 26.95401286-15.02354815 52.87699792-31.66728287 80.71474891-45.21793415 16.79102442-8.10093283 29.60522723-22.53532223 29.60522726-43.4504579 0.1472897-92.939793 0.29457937-185.73229631 0.14728969-278.6720893 0-11.19401627-5.15513907-13.99252034-13.84523067-7.06990501-26.51214381 20.76784598-57.29568854 34.46578693-86.16446735 51.25681135-54.49718448 31.81457257-109.14165865 63.33456576-163.78613282 95.00184862-8.54280189 4.8605597-11.78317502 10.45756784-11.63588535 20.47326662 0.29457937 96.18016613 0.1472897 192.50762194 0.1472897 288.68778806-0.29457937 3.5349525-1.47289687 7.65906378 3.38766282 10.8994369z",fill:"#066AF3"}),r.createElement("path",{d:"M96.20121136 636.3124965c1.91476594 1.03102783 1.91476594 2.06205563 0 3.09308345v-3.09308345z",fill:"#4372E0"}),r.createElement("path",{d:"M391.3697457 505.37196405c-5.44971845-44.33419602 13.84523065-74.08671296 61.4197998-94.55997955 30.93083443 1.17831749 58.03213699 10.31027814 74.38129233 38.5898982 15.75999659 27.39588193 14.13981003 63.48185543-12.81420282 90.14128893-23.27177067 22.97719129-58.47400606 26.65943349-86.31175705 10.45756783-18.11663161-10.60485751-30.34167568-25.03924691-36.67513226-44.62877541z",fill:"#002A9A"})),r.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16"},r.createElement("path",{d:"M24.65 399.36L965.485 7.314a29.257 29.257 0 0 1 39.643 34.085L770.78 978.87a29.257 29.257 0 0 1-47.104 15.36L520.192 824.686a29.257 29.257 0 0 0-39.424 1.828L376.393 930.816a29.257 29.257 0 0 1-49.883-20.626V689.737a29.257 29.257 0 0 1 8.557-20.7L759.515 244.59 258.414 620.47a29.257 29.257 0 0 1-36.28-0.95L17.19 448.805a29.257 29.257 0 0 1 7.46-49.445z",fill:"#333333","p-id":"5126"}))),c=r.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16"},r.createElement("path",{d:"M924.672 126.976q36.864 36.864 54.784 82.432t17.92 93.696-17.92 93.696-54.784 82.432l-392.192 389.12q-36.864 36.864-90.624 61.44t-113.664 28.672-122.368-16.384-115.712-73.728q-52.224-52.224-72.704-113.152t-16.384-121.344 28.16-113.664 60.928-90.112l348.16-345.088q9.216-9.216 27.136-4.608t27.136 13.824q8.192 9.216 13.312 27.136t-4.096 27.136l-347.136 344.064q-27.648 27.648-46.08 64.512t-21.504 78.848 12.288 84.992 55.296 82.944q35.84 35.84 79.36 50.688t86.528 12.288 81.92-18.944 66.56-44.032l391.168-388.096q27.648-27.648 39.424-57.344t11.264-58.88-13.824-56.832-36.864-51.2q-44.032-43.008-98.816-40.448t-110.08 57.856l-353.28 351.232q-23.552 23.552-23.04 52.224t18.944 47.104q22.528 22.528 51.712 18.432t47.616-22.528l320.512-318.464q9.216-9.216 27.136-4.608t27.136 13.824 14.336 27.136-4.096 27.136l-321.536 318.464q-36.864 36.864-70.656 51.2t-63.488 12.8-55.296-15.872-47.104-34.816q-17.408-16.384-31.232-41.984t-15.872-56.32 10.752-65.536 49.664-70.656q18.432-18.432 32.768-33.792 12.288-13.312 23.04-23.552t11.776-11.264l285.696-284.672q36.864-36.864 80.384-57.856t88.576-24.064 88.576 12.288 80.384 52.224z"}))},43700:(e,n,t)=>{t.d(n,{Z:()=>a});var r=t(90359),o=t(87465),i=t(83446),c=t(79127),s=t(90359);function a({ctx:e}){const n=e.curRoles,t=(0,r.useCallback)((()=>{e.showRoleMenu=!e.showRoleMenu}),[]),a=(0,r.useCallback)((n=>{e.showRoleMenu=!1,e.setCurRole(n),e.focusTextarea()}),[]);if(n){const r=e.curRole,l={backgroundColor:r.color};return s.createElement("div",{className:`${o.Z.roles}`},s.createElement("div",{className:`${o.Z.curRole} ${e.showRoleMenu?o.Z.openMenu:""}`,onClick:(0,i.Ft)(t).stop,"data-mybricks-tip":"选择AI角色"},s.createElement("label",null,"我是"),s.createElement("span",{style:l},r.title,c.PJ.ArrowDown)),e.showRoleMenu?s.createElement("div",{className:o.Z.roleMenu},n.map((e=>s.createElement("div",{onClick:n=>a(e)},e.title)))):null)}}},57720:(e,n,t)=>{t.d(n,{Z:()=>l});var r=t(90359),o=t(22896),i=t(79127),c=t(49698),s=t(3577),a=t(90359);function l({ctx:e}){var n;const t=(0,r.useCallback)((()=>{e.minimize()}),[]),l=(0,r.useCallback)((()=>{e.clearMessages()}),[]),d=e.curScene,p=e.isRunning(),u=e.getCurResponseAry(),b=e.curRole;return a.createElement("div",{className:`${o.Z.view} ${d?"":o.Z.disabled} ${e.errTryAgain?o.Z.error:""}`,style:{"--role-color":(null==b?void 0:b.color)||"--mybricks-color-primary"}},a.createElement("div",{className:o.Z.content,ref:n=>{n&&(e.contentEl=n)}},a.createElement(c.G,{ctx:e,myResAry:u})),a.createElement("div",{className:`${o.Z.curScene} ${p?o.Z.running:""}`},a.createElement("label",null,null===(n=e.curScene)||void 0===n?void 0:n.title),u.length>0?a.createElement("span",{className:o.Z.iconClear,"data-mybricks-tip":"清空",onClick:l},i.PJ.Clear):null,a.createElement("span",{className:o.Z.iconMini,"data-mybricks-tip":"隐藏",onClick:t},i.PJ.Minimize)),a.createElement(s.Z,{ctx:e}))}},3577:(e,n,t)=>{t.d(n,{Z:()=>u});var r=t(90359),o=t(86784),i=t(43700),c=t(6031),s=t(79127),a=t(51319),l=t(81230),d=t(83446),p=t(90359);function u({ctx:e}){const n=e.curScene,t=e.curRole;let s;s=n?"ing"===e.curScene.status?"处理中...":t.placeholder||"请问您的问题是什么？":"当前不支持AI";const d=(0,r.useCallback)((n=>{n?((0,a.g)(`出错了，请修正错误。错误信息：${e.errTryAgain.errorMsg}`,"user",l.F.ARCHITECT,e),e.clearTryAgain()):e.clearTryAgain()}),[]),u=(0,r.useCallback)((()=>{const n=e.getCurResponseAry();return n[n.length-1]}),[]),f=(0,r.useCallback)((()=>{u().resultVersion.confirm()}),[]),g=(0,r.useCallback)((()=>{u().resultVersion.cancel()}),[]),h=(0,r.useCallback)((()=>{u().resultVersion.tryAgain()}),[]);if(e.errTryAgain)return p.createElement("div",{className:`${o.Z.tb}`},p.createElement("div",{className:o.Z.llmIcon},e.getLLMIcon()),p.createElement("div",{className:o.Z.onError},p.createElement("p",null,"发生错误：",p.createElement("div",null,e.errTryAgain.errorMsg),"是否让助手尝试修正错误？"),p.createElement("div",null,p.createElement("button",{onClick:e=>d(!0)},"是"),p.createElement("button",{onClick:e=>d(!1)},"否"))));if("ing"===e.curScene.status)return p.createElement("div",{className:`${o.Z.tb}`},p.createElement("div",{className:o.Z.llmIcon},e.getLLMIcon()),p.createElement("div",{className:o.Z.llmIng},p.createElement("label",null,p.createElement("span",null,t.title)),p.createElement("div",{className:o.Z.loader}),p.createElement("p",null,"开发中，请稍后")));if("confirm"===e.curScene.status)return p.createElement("div",{className:`${o.Z.tb}`},p.createElement("div",{className:o.Z.llmIcon},e.getLLMIcon()),p.createElement("div",{className:o.Z.llmConfirm},p.createElement("label",null,p.createElement("span",null,t.title)),p.createElement("p",null,"对于当前结果"),p.createElement("div",{className:o.Z.btns},p.createElement("button",{className:o.Z.btnApply,onClick:f},"采用"),p.createElement("button",{className:o.Z.btnTryAgain,onClick:h},"重试"),p.createElement("button",{className:o.Z.btnCancel,onClick:g},"不理想，继续沟通"))));const x=e.curAttachment;return p.createElement("div",{className:`${o.Z.tb}`,onClick:n=>{e.showRoleMenu=!1}},p.createElement("div",{className:o.Z.llmIcon},e.getLLMIcon()),p.createElement(i.Z,{ctx:e}),p.createElement(b,{ctx:e}),p.createElement("textarea",{placeholder:s,disabled:!n||"ing"===e.curScene.status,style:{top:x?53:27},ref:n=>{n&&(e.textEl=n)},onKeyDown:n=>{if("Enter"===n.key&&n.shiftKey);else if("Enter"===n.key){const t=n.currentTarget.value;t&&""!==t.trim()&&(0,a.g)(n.currentTarget.value,"user",void 0,e)}},value:e.curRequest,onChange:n=>e.curRequest=n.target.value}),p.createElement("div",{className:o.Z.submit,"data-role-color":t.color,"data-mybricks-tip":"提交",onClick:n=>{const t=e.textEl.value;t&&""!==t.trim()&&(0,a.g)(t,"user",void 0,e)}},c.k4),p.createElement(m,{ctx:e}))}function b({ctx:e}){const n=e.curAttachment,t=(0,r.useCallback)((()=>{e.curAttachment=void 0}),[]),[i,c]=(0,r.useState)(!1);if(n)return p.createElement("div",{className:o.Z.curAttach,onMouseEnter:e=>{c(!0)},onMouseLeave:e=>{c(!1)}},p.createElement("img",{src:n.base64}),p.createElement("label",null,n.title,p.createElement("br",null),n.size,"kB"),p.createElement("span",{onClick:t,"data-mybricks-tip":"移除附件"},s.PJ.Close),i?p.createElement("div",{className:o.Z.showImg,onMouseLeave:e=>{c(!1)}},p.createElement("img",{src:n.base64})):null)}function m({ctx:e}){var n;const t=e.curRole,i=null===(n=t.attachment)||void 0===n?void 0:n.join(","),s=(0,r.useRef)(),a=(0,r.useCallback)((n=>{if(n.size>524288)return void e.emitMessage.warn("仅允许上传不超过500K的文件");let t,r,o=new FileReader;o.readAsDataURL(n),o.onload=function(o){const i=new Image;i.onload=function(){t=i.width,r=i.height};const c=o.target.result;e.curAttachment={title:n.name,size:(n.size/1e3).toFixed(2),base64:c},i.src=c}}),[]),l=(0,r.useCallback)((n=>{const t=n.target.files[0];if(!t)return;t.name.slice(t.name.lastIndexOf(".")+1).match(/png|jpg/)?a(t):e.emitMessage.warn(`只支持${i}格式的文件`)}),[]),u=(0,d.vc)((()=>t.attachment));if((0,r.useEffect)((()=>{u&&e.textEl&&e.textEl.addEventListener("paste",(function(e){const n=e.clipboardData.items;for(let t=0;t<n.length;t++){const r=n[t];if("file"==r.kind){const n=r.getAsFile();a(n),e.stopPropagation(),e.preventDefault();break}}}))}),[]),u)return p.createElement("div",{className:o.Z.files,"data-mybricks-tip":"添加附件",onClick:e=>{s.current.click()}},p.createElement("input",{ref:s,type:"file",onChange:l,accept:i}),c.Pg)}},49698:(e,n,t)=>{t.d(n,{G:()=>d});var r=t(22896),o=t(36525),i=t(90359),c=t.n(i),s=t(79127),a=t(24318),l=t(83446);function d({ctx:e,myResAry:n}){return n.map(((e,n)=>{const t=[];return"loading"===e.status?t.push(c().createElement("span",{key:n,className:`${r.Z[e.status]}`},"(处理中)")):"apiDone"===e.status?t.push(c().createElement("span",{key:n,className:`${r.Z[e.status]}`},"设置OpenAI API Key完成")):"ing"===e.status||"done"===e.status?t.push(c().createElement(p,{key:n,item:e})):"error"===e.status&&t.push(c().createElement("span",{key:n,className:`${r.Z[e.status]}`},"(",e.resultHTML,")")),c().createElement(i.Fragment,{key:n},c().createElement("div",{className:`${r.Z.request}`},c().createElement("span",null,e.content)),t)}))}function p({item:e}){const n=(0,i.useRef)();return(0,i.useEffect)((()=>{let e=e=>{const n=e.target;if(n.dataset.codeBtn){const t=n.parentNode;t.clientHeight<36?(n.innerText="收起",t.style.height="auto",t.querySelectorAll("code").forEach((e=>{e.style.display="block"}))):(n.innerText="展开",t.style.height="32px",t.querySelectorAll("code").forEach((e=>{e.style.display="none"}))),e.stopPropagation()}};return n.current&&n.current.addEventListener("click",e),()=>{n.current&&n.current.removeEventListener("click",e)}}),[n.current]),c().createElement(c().Fragment,null,c().createElement("div",{ref:n,"data-role-title":e.role.title,"data-role-color":e.role.color,className:`${r.Z[e.status]}`,dangerouslySetInnerHTML:{__html:e.resultHTML}}),c().createElement(u,{item:e}))}function u({item:e}){const[n,t]=(0,i.useState)(!1),r=(0,i.useRef)(),s=(0,i.useCallback)((()=>{confirm("确定采用此版本吗？")&&e.resultVersion.apply()}),[]);if(e.resultVersion){const{meta:i,_used:l,_unused:d}=e.resultVersion,p=!l&&!d,u=[o.Z.preview];let m;return l?(u.push(o.Z.used),m=c().createElement("span",null,"已采用")):d?(u.push(o.Z.unused),m=c().createElement("span",null,"未采用")):u.push(o.Z.confirm),c().createElement(c().Fragment,null,c().createElement("div",{className:`${u.join(" ")}`,ref:r},c().createElement("div",{className:o.Z.tt},m,c().createElement("label",null,i.version)),c().createElement("div",{className:o.Z.content},c().createElement("label",null,null==i?void 0:i.title),c().createElement("button",{className:o.Z.btnPreview,"data-mybricks-tip":"预览该版本的效果",onClick:e=>{t(!0)}},"预览"),p?null:c().createElement("button",{className:o.Z.btnApply,"data-mybricks-tip":"采用该版本，并且清除后续的版本",onClick:s},"采用"))),n?(0,a.createPortal)(c().createElement(b,{item:e,setShow:t}),document.body):null)}}function b({item:e,setShow:n}){const{com:t,meta:r,_used:a,_unused:d}=e.resultVersion,[p,u]=(0,i.useState)({width:r.width,height:r.height}),b=(0,i.useRef)(),[m,f]=(0,i.useState)({showSelectors:!1});(0,i.useMemo)((()=>{if(b.current){const e=r.selectors;Array.isArray(e)&&(m.showSelectors?e.forEach((e=>{if(e.selector){const n=b.current.querySelector(e.selector);n&&n.setAttribute("data-ai-zone-selector",e.selector)}})):e.forEach((e=>{if(e.selector){const n=b.current.querySelector(e.selector);n&&n.removeAttribute("data-ai-zone-selector")}})))}}),[m.showSelectors,b.current]);const g=(0,i.useCallback)((e=>{let n,t=p.width,r=p.height;(0,l.qw)(e,(({po:{x:e,y:o},epo:{ex:i,ey:c},dpo:{dx:s,dy:a},adpo:{adx:l,ady:d}},p)=>{if("moving"==p){n;u({width:t+2*l,height:r+2*d})}}))}),[p.width,p.height]);return c().createElement("div",{className:o.Z.popup},c().createElement(s.Vx,{title:"组件发生错误"},c().createElement("div",{onClick:(0,l.Ft)().stop,style:{width:p.width,height:p.height}},c().createElement("div",{className:o.Z.toolbar},c().createElement("div",{className:o.Z.ver},r.version),c().createElement("div",{className:`${o.Z.showSelector} ${m.showSelectors?o.Z.checked:""}`,onClick:e=>{f({showSelectors:!m.showSelectors})}},c().createElement("label",null,"选区"))),c().createElement("span",{className:o.Z.close,onClick:e=>{n(!1)}},s.PJ.Close),c().createElement("div",{className:o.Z.content,ref:b},c().createElement(t,null)),c().createElement("span",{className:o.Z.resizer,onMouseDown:g,onClick:(0,l.Ft)().stop}))))}},81230:(e,n,t)=>{t.d(n,{F:()=>r});const r={IMAGE:"image",ARCHITECT:"architect"}},70187:(e,n,t)=>{t.r(n),t.d(n,{default:()=>a});t(22896);var r=t(83446),o=t(79127),i=t(98228),c=t(59551),s=t(90359);function a(){const e=(0,r.N7)(o.zz,{from:"parents"}),n=(0,r.mA)(o.cA.Message,{expectTo:"parents"}),t=(0,r.mA)(i.Z,(t=>{t({context:e,emitMessage:n})}));return(0,r.vc)((()=>{let n;if(0==e.focusModelAry.length&&(n=e.focusDefault),1==e.focusModelAry.length&&(n=e.focusModelAry[0]),e.isDebugMode()||!n||"function"!=typeof n.getAssist)return;if(t.curModel,t.isRunning()||t.isConfirming())return;const r=null==n?void 0:n.getAssist();if(r){if(!r.type||!r.type.match(/geoCom|scene/))return;t.setCurScene(r),t.updateScene=()=>{const e=n.getAssist();e?t.setCurScene(e):t.clear()}}else t.clear();t.curModel=n})),s.createElement(c.Z,{ctx:t})}},51319:(e,n,t)=>{t.d(n,{g:()=>i});var r=t(81230),o=t(83446);function i(e,n,t,c,s){const a=c.curScene;if(a){requestAnimationFrame((e=>{c.curRequest=""}));const l=c.getCurResponseAry();if(e){const n={id:(0,o.Vj)(),targetTitle:a.title,focusArea:a.getFocusArea(),content:e,status:"loading"};l.push(n)}c.curScene.status="ing";const d=c.curRole,p=l[l.length-1];p.role=d,p.status="ing";let u=1;const b=()=>{const e=u++%2;return".....".repeat(e)},m=c.curAttachment;c.curAttachment=void 0,requestAnimationFrame((e=>{c.scrollContent()})),c.request({role:d,reqRole:n,aiRole:t,question:e,attachments:m,getStartAIRole:()=>a.getStartAIRole(),getSystemPrompts:()=>a.getSystemPrompts(d,{question:e,attachments:m}),getPromptAppended:()=>a.getPromptAppended({question:e,attachments:m}),getTools:()=>{if("function"==typeof a.getTools)return a.getTools()},emits:{write(e){let n=(p.resultHTMLOri||"")+e;if(n.startsWith("M:"))n=n.replace(/^M:/,"");else if(n.startsWith("F:")){const e=n.replace(/^F:/,"");if(e)return p.toolCallsMessage=e,p.resultHTMLOri=void 0,p.resultHTML='<div data-type="cmd">已执行指令</div>',void requestAnimationFrame((e=>{c.scrollContent()}))}p.resultHTMLOri=n;let t=n;t=t.replaceAll(/```([^\n]+)\n([\s\S]*?)```/g,((e,n,t)=>"json"===n?e:`[${n} 完成]`)),t=t.replaceAll(/```((?!json).)+[\s\S]*/g,((e,n,t)=>`处理中,请稍后..${b()}`)),t=t.replace(/\n/g,"<br/>"),t=t.replace(/\s/g,"&nbsp;&nbsp;"),t=t.replace(/(#+)(.*?)(<br\/>)/g,"<br/><b>$2</b><br/>"),t=t.replace(/(\*\*)(.*?)(\*\*)/g,"<b>$2</b>"),t=t.replace(/(<br\/>){3,}/g,"<br/><br/>"),p.resultHTML=t,requestAnimationFrame((e=>{c.scrollContent()}))},complete(){c.curScene.status="done",p.status="done";const e=c.messages[c.curScene.id][d.id],n=e[e.length-1];if(n.content&&Array.isArray(n.content)&&(n.content=n.content.filter((e=>{if("image_url"!==e.type||!e.image_url)return e}))),p.toolCallsMessage)"function"==typeof c.curScene.execute&&c.curScene.execute({toolCallsMessage:p.toolCallsMessage},{previewForConfirm(e,n){},appendPrompt(e){e&&c.appendMessage("_default",{role:"user",content:e})},appendMessage(e){prompt&&c.appendMessage("_default",e)},request(e,n){const{content:t,reqRole:r}=e||{};i(t,r,void 0,c,(()=>{if(c.setCurRole(d),"function"==typeof n){const e=n();e&&e.appendPrompts&&c.appendMessage(d.id,{role:"user",content:e.appendPrompts})}}))}}).then((e=>{const n=c.messages[c.curScene.id][d.id];n&&n.push({role:"assistant",content:c.curResponseOri}),"function"==typeof s&&s()})).catch((e=>{console.error(e),c.setTryAgain("_default",e.message)}));else if(p.resultHTMLOri){c.curResponseOri=p.resultHTMLOri;let e=p.resultHTMLOri;e=e.replace(/```([^\n<]+)([\s\S]*?)```/g,((e,n,t)=>{if("load"===n)return'<div data-type="load">加载类库</div>';if("cmd"===n)return'<div data-type="cmd">已执行指令</div>';return`\n<pre>\n<label>${n}</label>\n<button data-code-btn='show'>查看</button>\n<code>${t.replace(/</g,"&lt;").replace(/>/g,"&gt;")}</code>\n</pre>`})),e=e.replace(/```/g,""),e=e.replace(/\n/g,"<br/>"),e=e.replace(/<code\><br\/>/g,"<code>"),e=e.replace(/<pre\><br\/>/g,"<pre>"),e=e.replace(/(<br\/>)?\[完成\]<br\/>/g,"[完成] "),e=e.replace(/(#+)(.*?)(<br\/>)/g,"<br/><b>$2</b><br/>"),e=e.replace(/(\*\*)(.*?)(\*\*)/g,"<b>$2</b>"),e=e.replace(/(<br\/>){3,}/g,"<br/><br/>"),p.resultHTML=e;const n={};let t=p.resultHTMLOri;t=t.replace(/```([^\n]+)\n([\s\S]*?)```/g,((e,t,r)=>{const o=t.replace(/^\s*|\s*$/g,"");return n[o]=r,`${o}代码`})),n.content=t,p.resultHTMLOri="","function"==typeof c.curScene.execute&&c.curScene.execute(n,{previewForConfirm(e,n){let t=0;l.forEach((e=>{e.resultVersion&&t++}));const o={com:e,meta:Object.assign(Object.assign({},n.meta),{version:`v${t+1}`}),confirm(){n.confirm(),c.curScene.status="done",this._used=!0,c.appendMessage(c.curRole.id,{role:"user",content:"(我采用了当前版本)"})},apply(){n.confirm(),this._used=!0,c.applyMessage(p.id),c.appendMessage(c.curRole.id,{role:"user",content:"(我采用了当前版本)"})},cancel(){c.curScene.status="done",this._unused=!0,c.appendMessage(c.curRole.id,{role:"user",content:"(我未采用该版本,请根据后续的信息进行调整)"})},tryAgain(){c.curScene.status="done",this._unused=!0,i("该版本不符合要求，请再次尝试","user",r.F.ARCHITECT,c)}};p.resultVersion=o,c.curScene.status="confirm",setTimeout((e=>{c.scrollContent()}))},focusArea:p.focusArea,syncMessage(e){c.syncMessage(d,e)},appendPrompt(e){e&&c.appendMessage("_default",{role:"user",content:e})},appendMessage(e){e&&c.appendMessage("_default",e)},request(e,n){const{content:t,reqRole:r}=e||{};i(t,r,void 0,c,(()=>{if(c.setCurRole(d),"function"==typeof n){const e=n();e&&e.appendPrompts&&c.appendMessage(d.id,{role:"user",content:e.appendPrompts})}}))}}).then((e=>{c.messages[c.curScene.id][d.id].push({role:"assistant",content:c.curResponseOri}),"function"==typeof s&&s()})).catch((e=>{console.error(e),c.setTryAgain("_default",e.message)})),requestAnimationFrame((e=>{c.scrollContent()}))}c.textEl&&c.textEl.focus()},error(e){c.curScene.status="error",p.status="error",e instanceof Error?p.resultHTML=e.message:p.resultHTML=e}}})}}}}]);