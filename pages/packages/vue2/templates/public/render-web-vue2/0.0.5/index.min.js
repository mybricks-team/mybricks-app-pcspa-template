(function(n,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],e):(n=typeof globalThis<"u"?globalThis:n||self,e(n._mybricks_render_web_vue2={},n.Vue))})(this,function(exports,Vue){"use strict";var Ue=Object.defineProperty;var qe=(n,e,t)=>e in n?Ue(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var He=(n,e,t)=>(qe(n,typeof e!="symbol"?e+"":e,t),t);var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var fn={exports:{}};(function(module,exports){(function(n,e){module.exports=e()})(commonjsGlobal,()=>(()=>{var __webpack_modules__={356:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function __WEBPACK_DEFAULT_EXPORT__({data,outputs,inputs,onError}){inputs.from((val,relOutpus)=>{var _a;const script=(_a=data.exchange)===null||_a===void 0?void 0:_a.script;if(script){let fn,returnVal,isOk;try{eval(`fn = ${script}`),returnVal=fn(val),isOk=!0}catch(n){console.error(n),onError(`数据转换错误:${n.message}`,n)}isOk&&outputs.to(returnVal)}else onError("未配置转换规则")})}__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__})}},__webpack_module_cache__={};function __webpack_require__(n){var e=__webpack_module_cache__[n];if(e!==void 0)return e.exports;var t=__webpack_module_cache__[n]={exports:{}};return __webpack_modules__[n](t,t.exports,__webpack_require__),t.exports}__webpack_require__.d=(n,e)=>{for(var t in e)__webpack_require__.o(e,t)&&!__webpack_require__.o(n,t)&&Object.defineProperty(n,t,{enumerable:!0,get:e[t]})},__webpack_require__.o=(n,e)=>Object.prototype.hasOwnProperty.call(n,e),__webpack_require__.r=n=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})};var __webpack_exports__={};return(()=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>w,getCom:()=>_});const n=JSON.parse('{"title":"Fn计算","namespace":"mybricks.core-comlib.fn","author":"CheMingjun","author_name":"车明君","version":"1.0.0","description":"Fn计算","icon":"./icon.png","runtime":"./Fn.tsx","rtType":"js","visibility":false}'),e=JSON.parse('{"visibility":false,"title":"变量","namespace":"mybricks.core-comlib.var","author":"CheMingjun","author_name":"车明君","version":"1.0.0","description":"变量","icon":"./icon.png","data":"./data.json","runtime":"./Var.tsx","editors":"./editors.tsx","rtType":"js","inputs":[{"id":"get","title":"读取","schema":{"type":"any"},"rels":["return"]},{"id":"set","title":"赋值","schema":{"type":"follow"},"rels":["return"]},{"id":"reset","title":"重置","schema":{"type":"any"}}],"outputs":[{"id":"return","title":"完成","schema":{"type":"unknown"}},{"id":"changed","title":"当值发生变化","schema":{"type":"unknown"}}]}');function t(u){if(u&&typeof u=="object")try{return u instanceof FormData?u:JSON.parse(JSON.stringify(u))}catch{return u}return u}const o=JSON.parse('{"title":"类型转换","visibility":false,"namespace":"mybricks.core-comlib.type-change","author":"CheMingjun","author_name":"车明君","version":"1.0.0","description":"类型转换","icon":"./icon.png","runtime":"./rt.tsx","editors":"./editors.tsx","rtType":"js","inputs":[{"id":"from","title":"从","schema":{"type":"follow"},"rels":["to"]}],"outputs":[{"id":"to","title":"到","schema":{"type":"follow"},"conMax":1,"editable":true}]}');var r=__webpack_require__(356);const p=JSON.parse('{"deprecated":true,"visibility":false,"title":"连接器","namespace":"mybricks.core-comlib.connector","author":"MyBricks","author_name":"MyBricks","version":"1.0.0","description":"连接器","runtime":"./runtime.ts","editors":"./editors.tsx","icon":"./icon.svg","rtType":"js-autorun","inputs":[{"id":"call","rels":["then","catch"],"title":"调用","schema":{"type":"object"}}],"outputs":[{"id":"then","title":"结果","schema":{"type":"unknown"}},{"id":"catch","title":"发生错误","schema":{"type":"string"}}]}');function l({env:u,data:b,outputs:x,onError:v},m={}){if(b.connector)try{u.callConnector(b.connector,m,b.connectorConfig).then(C=>{x.then(C)}).catch(C=>{x.catch(C)})}catch(C){console.error(C),x.catch(`执行错误 ${C.message||C}`)}else x.catch("没有选择接口")}const y=JSON.parse('{"visibility":false,"title":"作用域输入","namespace":"mybricks.core-comlib.frame-input","author":"CheMingjun","author_name":"车明君","version":"1.0.0","description":"作用域输入","rtType":"js","runtime":"./runtime.ts","editors":"./editor.tsx","inputs":[{"id":"getCurValue","title":"获取","schema":{"type":"any"},"rels":["return"]}],"outputs":[{"id":"return","title":"结果","schema":{"type":"follow"}}]}'),g=JSON.parse('{"visibility":false,"title":"打开对话框","namespace":"mybricks.core-comlib.scenes","author":"CheMingjun","author_name":"车明君","version":"1.0.0","description":"切换场景","icon":"./icon.png","runtime":"./runtime.ts","data":"./data.json","rtType":"js","inputs":[{"id":"open","title":"打开","schema":{"type":"any"}}]}'),f=JSON.parse('{"title":"模块","namespace":"mybricks.core-comlib.module","author":"CheMingjun","author_name":"车明君","version":"1.0.0","description":"模块","icon":"./icon.png","data":"./data.json","runtime":"./runtime.tsx","editors":"./editors.ts"}'),d={id:"mybricks-core-comlib",title:"Mybrics核心组件库",author:"CheMingjun",icon:"",version:"1.0.1",comAray:[O({comDef:n,rt:function({inputs:u,outputs:b}){}}),O({comDef:e,rt:function({env:u,data:b,outputs:x,inputs:v,_notifyBindings:m}){v.get((C,k)=>{const E=t(b.val!==void 0?b.val:b.initValue);k.return(E)}),v.set((C,k)=>{b.val=C;const E=t(C);x.changed(E,!0),m(E),k.return(E)}),v.reset(()=>{const C=b.initValue;b.val=C;const k=t(C);x.changed(k,!0),m(k)})}}),O({comDef:o,rt:r.Z}),O({comDef:p,rt:function({env:u,data:b,inputs:x,outputs:v,onError:m}){u.runtime&&(b.immediate?l({env:u,data:b,outputs:v}):x.call(C=>{l({env:u,data:b,outputs:v,onError:m},C)}))}}),O({comDef:y,rt:function({env:u,data:b,inputs:x,outputs:v}){u.runtime&&x.getCurValue((m,C)=>{C.return(m)})}}),O({comDef:g,rt:function({env:u,data:b,inputs:x,_inputs:v,_inputsCallable:m}){x.open(C=>{u.canvas.open(b._sceneId,C,b._sceneShowType==="popup"?null:b.openType),m._open(C)})}}),O({comDef:f,rt:function({env:u,data:b,inputs:x,outputs:v}){const m=u.getModuleJSON(b.definedId);return u.renderModule(m,{ref(C){const{inputs:k,outputs:E}=m;k.forEach(({id:N})=>{x[N](H=>{C.inputs[N](H)})}),E.forEach(({id:N})=>{C.outputs(N,v[N])});const J=b.configs;for(let N in J)C.inputs[N](J[N]);C.run()},disableAutoRun:!0})}})]},w=d;function _(u){return d.comAray.find(b=>b.namespace===u)}function O({comDef:u,rt:b,data:x}){return Object.assign(u,{runtime:b,data:x})}})(),__webpack_exports__})())})(fn);var fnExports=fn.exports;const coreLib=getDefaultExportFromCjs(fnExports);function logInputVal(n,e,t,o){let r;try{r=JSON.stringify(o)}catch{r=o}console.log(`%c [MyBricks] 输入项 %c ${n||e.title||e.namespace} | ${t} -> ${r}`,"color:#FFF;background:#000","","")}function logOutputVal(n,e,t,o){let r;try{r=JSON.stringify(o)}catch{r=o}console.log(`%c [MyBricks] 输出项 %c ${n||e.title||e.namespace} | ${t} -> ${r}`,"color:#FFF;background:#fa6400","","")}function isNumber(n){return typeof n=="number"&&!isNaN(n)}function uuid$1(n=5,e=8){const t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),o=[];if(e=e||t.length,n)for(let r=0;r<n;r++)o[r]=t[0|Math.random()*e];else{let r;o[8]=o[13]=o[18]=o[23]="-",o[14]="4";for(let p=0;p<36;p++)o[p]||(r=0|Math.random()*16,o[p]=t[p==19?r&3|8:r])}return o.join("")}function convertCamelToHyphen(n){return n.replace(/([A-Z])/g,"-$1").toLowerCase()}const toFixed=function n(e,t){var o=Math.pow(10,t+1),r=Math.floor(e*o);return Math.round(r/10)*10/o},createPxReplacer=function n(e,t,o,r){return function(p,l){var y=parseFloat(l);return!l||y<=t?p:"".concat(toFixed(y/e,o)).concat(r)}},remReplace=createPxReplacer(12,0,5,"rem"),vwReplace=createPxReplacer(3.75,0,5,"vw"),REG_PX=/"[^"]+"|'[^']+'|url\([^)]+\)|(\d*\.?\d+)px/g,pxToRem=n=>n.replace(REG_PX,remReplace),pxToVw=n=>n.replace(REG_PX,vwReplace);function dataSlim(n){return n}function easyClone(n){if(n&&typeof n=="object")try{return n instanceof FormData?n:JSON.parse(JSON.stringify(n))}catch{return n}return n}const ROOT_FRAME_KEY="_rootFrame_";function executor(n,{observable:e}){const{json:t,getComDef:o,env:r,ref:p,onError:l,logger:y,debug:g,debugLogger:f,_isNestedRender:d,_context:w}=n,_=n.scenesOperate||r.scenesOperate,{slot:O,coms:u={},comsAutoRun:b={},cons:x=[],pinRels:v={},pinProxies:m={},pinValueProxies:C={},type:k}=t,E=r,J={},N={},H={},q={},ye={};Object.keys(x).forEach(c=>{const i=x[c],{startPinParentKey:s}=i[0];s&&(ye[s]=c)});const he={},de={},je={},Se={},ve={},G={};function me(c,i,s){if(!d){if(c==="com"){const{com:$,pinHostId:j,val:a,fromCon:S,notifyAll:F,comDef:h,conId:I}=i;f?f("com","output",{id:$.id,pinHostId:j,val:a,fromCon:S,notifyAll:F,comDef:h,sceneId:t.id,conId:I},s):logOutputVal($.title,h,j,a)}else if(c==="frame"){const{comId:$,frameId:j,pinHostId:a,val:S,sceneId:F,conId:h}=i;f&&f("frame","output",{comId:$,frameId:j,pinHostId:a,val:S,sceneId:F||t.id,conId:h},s)}}}function ge(c,i){if(d)return;const{com:s,pinHostId:$,val:j,frameKey:a,finishPinParentKey:S,comDef:F,conId:h}=c;h&&(f?f("com","input",{id:s.id,pinHostId:$,val:j,frameKey:a,finishPinParentKey:S,comDef:F,sceneId:t.id,conId:h},i):logInputVal(s.title,F,$,j))}function Y(c,i,s,$){var S,F,h;const j=m[c.comId+"-"+c.pinId];let a=c;if(j){const I=((S=a.def)==null?void 0:S.namespace)==="mybricks.core-comlib.frame-output";if(I)a={...c,type:j.type,frameId:j.frameId,pinId:j.pinId,direction:"inner-input",comId:(c.targetFrameKey||c.frameKey).split("-")[0]};else{if(je[`${j.frameId}-${j.pinId}`]=s,$&&$.finishPinParentKey!==a.startPinParentKey)return;if(j.type==="frame"){const V=le(a.comId,i);let ee;if(ee={id:uuid$1(10,16),frameId:j.frameId,parent:i,proxyComProps:V},a.def.namespace==="mybricks.core-comlib.fn"){const{configs:A}=V.data;A&&Object.entries(A).forEach(([M,T])=>{const{frameId:U,comId:R,pinId:P}=j,K=R?`${R}-${U}`:`${U}`,B=x[K+"-"+M];B&&X({logProps:null,cons:B,val:T,curScope:ee})})}Be({options:j,value:s,scope:ee,comProps:V}),I||Ae({frameId:j.frameId,scope:ee});return}}}if(a.type==="com")$?$.finishPinParentKey===a.startPinParentKey&&ce(a,s,i):ce(a,s,i);else if(a.type==="frame"){if($&&$.finishPinParentKey!==a.startPinParentKey)return;if(a.comId){if(a.direction==="inner-input"){const I=N[a.frameKey+"-"+a.pinId]||N[a.comId+"-"+a.frameId+"-"+((F=i==null?void 0:i.parent)!=null&&F.id?i.parent.id+"-":"")+a.pinId];I&&I(s)}else if(a.direction==="inner-output"&&a.pinType==="joint"){const I=x[a.comId+"-"+a.frameId+"-"+a.pinId];I&&X({logProps:null,cons:I,val:s})}}else{const I=i==null?void 0:i.proxyComProps;if(I){const V=I.outputs[a.pinId];if(V){V(s,i.parent);return}}(h=q[a.pinId])==null||h.call(q,s)}}else throw new Error("尚未实现")}function X({logProps:c,cons:i,val:s,curScope:$,fromCon:j,notifyAll:a,fromCom:S,isAutoRun:F}){g&&k!=="module"&&i.sort((h,I)=>h.isBreakpoint&&!I.isBreakpoint?-1:!h.isBreakpoint&&I.isBreakpoint?1:0),i.forEach(async h=>{var T,U;const{comId:I,pinId:V,pinType:ee,timerPinInputId:D,frameKey:A}=h,M=u[I];if(!(j&&j.finishPinParentKey!==h.startPinParentKey)&&!(g&&h.isIgnored)){if(g&&k!=="module"&&((T=w.debuggerPanel)!=null&&T.hasBreakpoint(h))){let R=!0;await((U=w.debuggerPanel)==null?void 0:U.wait(h,()=>{R=!1,c&&(c[1].conId=h.id,c&&me(...c,!0))})),R&&c&&(c[1].conId=h.id,c&&me(...c))}else c&&me(...c);if(ee==="timer")ne({value:s,curScope:$,inReg:h,notifyAll:a,fromCon:j});else if(a){const R=h.frameKey;if(R===ROOT_FRAME_KEY||F)oe({pinId:V,value:s,component:M,curScope:null,comId:I,val:s,timerPinInputId:D,frameKey:R,inReg:h,notifyAll:a,fromCon:j});else{const[P,K]=R.split("-");if(Se[R]){const B=Se[R],Z=B[S.id];Z?Z[h.id]=h:B[S.id]={[h.id]:h}}else{const B=Se[R]={};B[S.id]={[h.id]:h}}if(S.parentComId)oe({pinId:V,value:s,component:M,curScope:$,comId:P,val:s,timerPinInputId:D,frameKey:R,inReg:h,notifyAll:a,fromCon:j});else{const B=J[`${P}-${K}`];if(B){const Z=Object.entries(B),ie=Z.length;Z.forEach(([ue,pe])=>{ie>1&&ue==="slot"||((pe==null?void 0:pe.type)==="scope"?pe.curScope?oe({pinId:V,value:s,component:M,curScope:pe.curScope,comId:P,val:s,timerPinInputId:D,frameKey:R,inReg:h,notifyAll:a,fromCon:j}):pe.pushTodo(be=>{oe({pinId:V,value:s,component:M,curScope:be,comId:P,val:s,timerPinInputId:D,frameKey:R,inReg:h,notifyAll:a,fromCon:j})}):oe({pinId:V,value:s,component:M,curScope:pe.curScope,comId:P,val:s,timerPinInputId:D,frameKey:R,inReg:h,notifyAll:a,fromCon:j}))})}}}}else oe({pinId:V,value:s,component:M,curScope:$,comId:I,val:s,timerPinInputId:D,frameKey:A,inReg:h,notifyAll:a,fromCon:j})}})}function ne({pinId:c,value:i,curScope:s,inReg:$,notifyAll:j,fromCon:a}){let S=s;const F=c?{...$,pinId:c}:$;if(j){const h=F.frameKey;if(!h)throw new Error("数据异常，请检查toJSON结果.");h===ROOT_FRAME_KEY?Y(F,{},i,a):Y(F,s,i,a)}else{const h=F.frameKey.split("-");if(h.length>=2&&!S){const I=Ke(h[0],h[1],null,!1);(I==null?void 0:I.type)==="scope"?I.curScope?Y(F,I.curScope,i,a):I.pushTodo(V=>{Y(F,V,i,a)}):Y(F,S,i,a)}else Y(F,S,i,a)}}function oe({pinId:c,value:i,component:s,curScope:$,comId:j,val:a,timerPinInputId:S,frameKey:F,inReg:h,notifyAll:I,fromCon:V}){const{isReady:ee,isMultipleInput:D,pinId:A,value:M,cb:T}=we({pinId:c,value:i,component:s,curScope:$,comId:j,val:a});if(ee){const U={pinId:D?A:null,value:M,curScope:$,inReg:h,notifyAll:I,fromCon:V};if(S){const R=S+"-"+F+($!=null&&$.id?`-${$.id}`:""),P=de[R];if(P){const{ready:K,todo:B}=P;if(K){let Z=!1;Object.entries(B).forEach(([ie,ue])=>{ie===A?(ne(U),Z=!0):ue()}),Z||ne(U),T==null||T(),Reflect.deleteProperty(de,R)}else B[A]=()=>{T==null||T(),ne(U)}}else de[R]={ready:!1,todo:{[A]:()=>{T==null||T(),ne(U)}}}}else T==null||T(),ne(U)}}function we({pinId:c,value:i,component:s,curScope:$,comId:j,val:a}){const S=c.indexOf("."),F={pinId:c,value:i,isReady:!0,isMultipleInput:!1,cb:null};if(s&&S!==-1){const h=s.id+`${$!=null&&$.id?`-${$.id}`:""}`,{inputs:I}=s,V=c.substring(0,S);F.pinId=V;const ee=c.substring(S+1);let D=he[h];D||(D=he[h]={}),D[ee]=a;const A=new RegExp(`${V}.`),M=I.filter(T=>!!T.match(A));Object.keys(D).length===M.length?(F.value=D,F.isMultipleInput=!0,F.cb=()=>{Reflect.deleteProperty(he,h)}):F.isReady=!1}return F}function le(c,i){var Ne,Re,Le;const s=u[c];if(!s)return null;const $=c+(s.frameId||ROOT_FRAME_KEY);let j=J[$];j||(j=J[$]={});let a,S=i;for(!S&&s.parentComId&&s.frameId&&(S=(Re=(Ne=J[`${s.parentComId}-${s.frameId}`])==null?void 0:Ne.slot)==null?void 0:Re.curScope);S;){const W=S.id+"-"+c;if(S.frameId===s.frameId){a=S.id;const L=j[W];if(L)return L;{const z=S.parentComId;if(z){if(z===s.paramId||z===s.parentComId)break}else break}}S=S.parent}const F=(a?a+"-":"")+c,h=j[F];if(h)return h;const I=s.def,V=s.model,ee=JSON.parse(JSON.stringify(V.data)),D=JSON.parse(JSON.stringify(V.style));D.__model_style__=!0;const A={},M={},T={},U=(W,L,z,te)=>{let Q=M[W];Q||(M[W]=Q=[]),Q.push({val:L,fromCon:z,fromScope:te})},R=function(W){return new Proxy({},{ownKeys(L){return s.inputs},getOwnPropertyDescriptor(L){return{enumerable:!0,configurable:!0}},get(L,z){return function(te){if(Object.prototype.toString.call(z)==="[object Symbol]")return;const Q=W==null?void 0:W.inputs;if(Q){const re=Q[z];typeof re=="function"&&re(te)}A[z]=te;const se=M[z];se&&(se.forEach(({val:re,fromCon:ae,fromScope:Oe})=>{te(re,new Proxy({},{get(xe,Ee){return function(Pe){if(Object.prototype.toString.call(Ee)==="[object Symbol]")return;const Ce=B()[Ee];if(typeof Ce=="function")Ce(Pe,Oe||S,ae);else throw new Error(`outputs.${Ee} not found`)}}}))}),M[z]=void 0)}}})},P=new Proxy({},{get(W,L){return function(z){if(Object.prototype.toString.call(L)==="[object Symbol]")return;const te=v[c+"-"+L];if(te){const Q={},se={};return te.forEach(re=>{Q[re]=ae=>{se[re]=ae}}),Promise.resolve().then(()=>{ce({comId:c,def:I,pinId:L},z,i,se)}),Q}else ce({comId:c,def:I,pinId:L},z,i)}}}),K=new Proxy({},{get(W,L){return function(z){if(Object.prototype.toString.call(L)==="[object Symbol]")return;const te=m[c+"-"+L];te&&(_==null||_.inputs({...te,value:z,parentScope:be}))}}}),B=function(W){return new Proxy({},{ownKeys(L){return s.outputs},getOwnPropertyDescriptor(L){return{enumerable:!0,configurable:!0}},get(L,z,te){const Q=function(se,re,ae,Oe){if(Object.prototype.toString.call(z)==="[object Symbol]")return;const xe=typeof re=="boolean"&&re;if(xe){if(s.parentComId){const _e=`${s.parentComId}-${s.frameId}`;G[_e]?G[_e][c]=!0:G[_e]={[c]:!0}}if(ve[`${s.id}${i!=null&&i.id?`-${i.id}`:""}`]=se,s.global&&!Oe){_==null||_.exeGlobalCom({com:s,value:se,pinId:z});return}}const Ee=arguments,Pe=W==null?void 0:W.outputs;if(Pe){const _e=Pe[z];typeof _e=="function"&&_e(se)}let Ce;re&&typeof re=="object"&&(Ce=re);const ke=o(I);if(!ke)return;const Je=V.outputEvents;let fe;if(Je){const _e=Je[z];if(_e&&Array.isArray(_e)){const Ve=_e.find(Te=>Te.active);if(Ve){const{type:Te}=Ve;switch(Te){case"none":fe=[];break;case"fx":const Fe=m[c+"-"+z];if((Fe==null?void 0:Fe.type)==="frame"){const Ie=`${Fe.frameId}-${Fe.pinId}`;fe=x[Ie]||[],je[Ie]=se}else fe=[];break;case"defined":break;default:if(fe=[],Array.isArray(r==null?void 0:r.events)){const Ie=r.events.find(ze=>{if(ze.type===Te)return ze});Ie&&typeof Ie.exe=="function"&&Ie.exe({options:Ve.options})}break}}}}fe=fe||x[c+"-"+z],fe!=null&&fe.length?Ee.length>=3&&typeof Oe>"u"?X({logProps:["com",{com:s,pinHostId:z,val:se,fromCon:ae,notifyAll:xe,comDef:ke}],cons:fe,val:se,curScope:Ce,fromCon:ae,fromCom:s}):X({logProps:["com",{com:s,pinHostId:z,val:se,fromCon:ae,notifyAll:xe,comDef:ke}],cons:fe,val:se,curScope:Ce||i,fromCon:ae,notifyAll:xe,fromCom:s}):me("com",{com:s,pinHostId:z,val:se,fromCon:ae,notifyAll:xe,comDef:ke})};return Q.getConnections=()=>x[c+"-"+z]||[],Q}})},Z=new Proxy({},{get(W,L,z){return function(te){if(Object.prototype.toString.call(L)==="[object Symbol]")return;const Q=T[L];Q&&(Q.forEach(se=>{te(se)}),T[L]=void 0)}}}),ie=new Proxy({},{get(W,L,z){return function(te){if(Object.prototype.toString.call(L)==="[object Symbol]")return;const Q=x[c+"-"+L];Q?X({logProps:["com",{com:s,pinHostId:L,val:te,comDef:I}],cons:Q,val:te,curScope:i}):me("com",{com:s,pinHostId:L,val:te,comDef:I})}}});function ue(W){if(s.global){_==null||_._notifyBindings(W,s);return}const{bindingsTo:L}=s.model;if(L)for(let z in L){const te=le(z);if(te){const Q=L[z];Array.isArray(Q)&&Q.forEach(se=>{let re=te;const ae=se.split(".");ae.forEach((Oe,xe)=>{xe!==ae.length-1?re=re[Oe]:re[Oe]=W})})}}}const pe=(Le=I.rtType)==null?void 0:Le.match(/^js/gi),be={id:s.id,title:s.title,frameId:s.frameId,parentComId:s.parentComId,data:pe?ee:e(ee),style:pe?D:e(D),_inputRegs:A,addInputTodo:U,inputs:R(),inputsCallable:P,_inputsCallable:K,outputs:B(),_inputs:Z,_outputs:ie,clone(W){const L={inputs:R(W),outputs:B(W)};return Object.setPrototypeOf(L,this),L},_notifyBindings:ue,logger:y,onError:g?W=>l({comId:c,error:W}):l};return j[F]=be,be}function $e(c,i){let s=je[`${c}${i?`-${i.id}-${i.frameId}`:""}`];return typeof s>"u"&&(i!=null&&i.parent)&&(s=$e(c,i.parent)),easyClone(s)}function ce(c,i,s,$){var D;const{comId:j,def:a,pinId:S,pinType:F,frameKey:h,finishPinParentKey:I,timerPinInputId:V,targetFrameKey:ee}=c;if(F==="ext"){const A=J[j]||le(j,s);if(S==="show")A.style.display="";else if(S==="hide")A.style.display="none";else if(S==="showOrHide"){const T=A.style;typeof i>"u"?T.display==="none"?T.display="":T.display="none":T.display=i?"":"none"}const M=o(a);if(!M)return;ge({com:A,val:i,pinHostId:S,frameKey:h,finishPinParentKey:I,comDef:M,conId:c.id})}else if(F==="config"){const A=le(j,s),M=o(a);if(!M)return;ge({com:A,pinHostId:S,val:i,frameKey:h,finishPinParentKey:I,comDef:M,conId:c.id});const{extBinding:T}=c,U=T.split(".");let R=A;U.forEach((P,K)=>{K!==U.length-1?R=R[P]:R[P]=i})}else if(F==="timer"){const A=le(j,s),M=o(a);if(!M)return;ge({com:A,pinHostId:S,val:i,frameKey:h,finishPinParentKey:I,comDef:M,conId:c.id});const T=V+"-"+h+(s!=null&&s.id?`-${s.id}`:""),U=de[T];if(U){const{todo:R}=U;Object.entries(R).forEach(([P,K])=>K()),Reflect.deleteProperty(de,T)}else de[T]={ready:!0,todo:{}}}else if((D=a.rtType)!=null&&D.match(/^js/gi)){const A=u[j];if(A){const M=le(j,s),T=o(a);if(!T)return;if(A.global){const K=_==null?void 0:_.getGlobalComProps(j);K&&(M.data=K.data)}const U=s==null?void 0:s.id,R=(U?U+"-":"")+j;A.inputs.find(K=>K===S)?ge({com:A,val:i,pinHostId:S,frameKey:h,finishPinParentKey:I,comDef:T,conId:c.id}):Object.entries(i).forEach(([K,B])=>{ge({com:A,val:B,pinHostId:`${S}.${K}`,frameKey:h,finishPinParentKey:I,comDef:T,conId:c.id})}),H[R]||(H[R]=!0,T.runtime({env:E,data:M.data,inputs:M.inputs,outputs:M.outputs,_notifyBindings:M._notifyBindings,_inputsCallable:M._inputsCallable,logger:y,onError:g?K=>l({comId:j,error:K}):l}));const P=M._inputRegs[S];typeof P=="function"&&P(i,new Proxy({},{get(K,B){return function(Z){if(Object.prototype.toString.call(B)!=="[object Symbol]"){if(C){const ie=C[`${j}-${S}`];if(ie){const pe=`${ie.frameId===t.id?ROOT_FRAME_KEY:ee||h}-${ie.pinId}`;Z=$e(pe,s),typeof Z>"u"&&(Z=$e(pe,null))}}M.outputs[B](Z,s,c)}}}}))}}else{const A=le(j,s);if(!A)return;const M=o(a);if(!M)return;ge({com:A,pinHostId:S,val:i,frameKey:h,finishPinParentKey:I,comDef:M,conId:c.id});const T=A._inputRegs[S];if(typeof T=="function"){let U;$?U=$:U=new Proxy({},{get(R,P){return function(K){Object.prototype.toString.call(P)!=="[object Symbol]"&&A.outputs[P](K,s,c)}}}),T(i,U)}else A.addInputTodo(S,i,c,s)}if(I){const A=x[ye[I]];A&&!v[`${j}-${S}`]&&X({logProps:null,cons:A,val:void 0})}}function De(c,i){let s;return c!=null&&c.comAry&&c.comAry.find($=>{if($.id===i)return s=$,$;if($.slots){for(let j in $.slots)if(s=De($.slots[j],i),s)return s}}),s}function Ke(c,i,s,$){const j=`${c}-${i}`;let a=J[j];a||(a=J[j]={});let S=s?s.id:"slot",F=a[S];if($&&!F&&console.log("不应该再走到这儿了: ",{comId:c,slotId:i,scope:s,notifyAll:$}),!F){const h=De(O,c);if(!(h!=null&&h.slots))return null;const I=h==null?void 0:h.slots[i],V={};let ee;if(s){const R=J[c+"-"+i];R&&(ee=R.todo)}const D={scope:s,todo:ee},A=new Proxy({},{get(R,P){return function(K){Object.prototype.toString.call(P)!=="[object Symbol]"&&(V[P]=K)}}}),M=new Proxy({},{get(R,P){const K=function(B,Z){if(Object.prototype.toString.call(P)==="[object Symbol]")return;const ie=c+"-"+i+"-"+P,ue=x[ie];je[`${ie}${Z?`-${Z.id}-${Z.frameId}`:""}`]=B,ue?X({logProps:["frame",{comId:c,frameId:i,pinHostId:P,val:B}],cons:ue,val:B,curScope:Z||D.scope}):me("frame",{comId:c,frameId:i,pinHostId:P,val:B})};return K.getConnections=()=>x[c+"-"+i+"-"+P]||[],K}}),T=new Proxy({},{get(R,P,K){return function(B){Object.prototype.toString.call(P)!=="[object Symbol]"&&(N[S+"-"+P]=B,N[j+"-"+P]=B)}}});let U={};F=a[S]={type:I==null?void 0:I.type,run(R){let P=D.scope;R&&P!==R&&(D.scope=R,P=R);const K=(P==null?void 0:P.id)||"none";if(U[K]||(U[K]=!0,Ae({comId:c,frameId:i,scope:P})),Array.isArray(D.todo)&&(D.todo.forEach(B=>{Promise.resolve().then(()=>{B(P)})}),D.todo=void 0),P&&S!=="slot"){const B=`${c}-${i}`,Z=Se[B];Promise.resolve().then(()=>{Z&&Object.entries(Z).forEach(([ie,ue])=>{if(!u[ie].parentComId){const be=Object.entries(ue).map(([Ne,Re])=>Re);be.length&&X({logProps:null,cons:be,val:ve[ie],curScope:P,notifyAll:!0,fromCom:u[ie],isAutoRun:!0})}})})}},destroy(){if(s){const R=`${s.parentComId}-${s.frameId}`,P=G[R];P&&Object.keys(P).forEach(K=>{Reflect.deleteProperty(ve,`${K}-${s.id}`)})}Reflect.deleteProperty(a,S)},_inputs:A,_inputRegs:V,inputs:M,outputs:T,get curScope(){return D.scope},setCurScope(R){D.scope=R},get todo(){return D.todo},pushTodo(R){D.todo||(D.todo=[]),D.todo.push(R)}}}return F}function Ae(c){const{comId:i,frameId:s,scope:$}=c,j=i?`${i}-${s}`:`${s}`,a=b[j];a&&a.forEach(S=>{const{id:F,def:h}=S;if(u[F]){const V=le(F,$),ee=o(h);if(!ee)return;ee.runtime({env:E,data:V.data,inputs:V.inputs,outputs:V.outputs,_inputsCallable:V._inputsCallable,logger:y,onError:g?D=>l({comId:F,error:D}):l})}})}function Be({options:c,value:i,scope:s=void 0,log:$=!0,comProps:j}){const{frameId:a,comId:S,pinId:F,sceneId:h}=c,I=S?`${S}-${a}`:`${a}`,V=x[I+"-"+F];je[`${a}-${F}`]=i,V?X({logProps:["frame",{comId:S,frameId:a,pinHostId:F,val:i,sceneId:h}],cons:V,val:i,curScope:s}):($&&me("frame",{comId:S,frameId:a,pinHostId:F,val:i,sceneId:h}),a!==ROOT_FRAME_KEY&&(t.id===a?q[F](i):_==null||_.open({frameId:a,todo:{pinId:F,value:i},comProps:j,parentScope:s.proxyComProps})))}const Me={get({comId:c,slotId:i,scope:s,_ioProxy:$}){let j;if($&&($.inputs||$.outputs||$._inputs||$._outputs)&&(j=$),i)return Ke(c,i,s);{const a=le(c,s);return j?a.clone(j):a}},getComInfo(c){return u[c]}};if(typeof p=="function"){const c={run(){Ae({frameId:ROOT_FRAME_KEY})},inputs:new Proxy({},{get(i,s){return function($,j=void 0,a=!0){Object.prototype.toString.call(s)!=="[object Symbol]"&&Be({options:{frameId:ROOT_FRAME_KEY,pinId:s,sceneId:j},value:$,scope:void 0,log:a})}}}),outputs(i,s){q[i]=s},get:Me.get,getComInfo:Me.getComInfo};p(c)}return Me}function normalizeComponent(n,e,t,o,r,p,l,y){var g=typeof n=="function"?n.options:n;e&&(g.render=e,g.staticRenderFns=t,g._compiled=!0),o&&(g.functional=!0),p&&(g._scopeId="data-v-"+p);var f;if(l?(f=function(_){_=_||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!_&&typeof __VUE_SSR_CONTEXT__<"u"&&(_=__VUE_SSR_CONTEXT__),r&&r.call(this,_),_&&_._registeredComponents&&_._registeredComponents.add(l)},g._ssrRegister=f):r&&(f=y?function(){r.call(this,(g.functional?this.parent:this).$root.$options.shadowRoot)}:r),f)if(g.functional){g._injectStyles=f;var d=g.render;g.render=function(O,u){return f.call(u),d(O,u)}}else{var w=g.beforeCreate;g.beforeCreate=w?[].concat(w,f):[f]}return{exports:n,options:g}}const _sfc_main$7={props:{slotId:{type:String},propsSlot:{type:Object},params:{type:Object},props:{type:Object},propsStyle:{type:Object},onError:{type:Function},logger:{type:Object},env:{type:Object},_env:{type:Object},scope:{type:Object},getComDef:{type:Function},context:{type:Object}},created(){let n;const{propsSlot:e,scope:t,props:o,env:r,_env:p,getComDef:l,registSpm:y,context:g,onError:f,logger:d,params:w}=this.$props;if(Object.assign(w,w.m),(e==null?void 0:e.type)==="scope"?(n={id:uuid(10,16),frameId:slotId},t&&(n.parent=t)):n=t,w){const _=w.inputValues;if(typeof _=="object")for(let O in _)o.inputs[O](_[O],n);typeof w.wrap=="function"&&w.wrap}o.run(n),this.slotProps={scope:n,env:r,_env:p,propsSlot:e,params:w,getComDef:l,registSpm:y,context:g,inputs:w==null?void 0:w.inputs,outputs:w==null?void 0:w.outputs,_inputs:w==null?void 0:w._inputs,_outputs:w==null?void 0:w._outputs,onError:f,logger:d},this.slotComponent=RenderSlot}};var _sfc_render$7=function n(){var e=this,t=e._self._c;return t(e.slotComponent,e._b({tag:"component"},"component",e.slotProps,!1))},_sfc_staticRenderFns$7=[],__component__$7=normalizeComponent(_sfc_main$7,_sfc_render$7,_sfc_staticRenderFns$7,!1,null,null,null,null);const SlotRender=__component__$7.exports,_sfc_main$6={functional:!0,props:{env:Object,data:Object,inputs:Object,outputs:Object},render(n,{props:e}){const t=e.env.getModuleJSON(e.data.definedId);return n(Render,{props:e.env.renderModule(t,{ref:o=>{const{inputs:r,outputs:p}=t;r.forEach(({id:y})=>{e.inputs[y](g=>{o.inputs[y](g)})}),p.forEach(({id:y})=>{o.outputs(y,e.outputs[y])});const l=e.data.configs;for(let y in l)o.inputs[y](l[y]);o.run()},disableAutoRun:!0})})}},_sfc_render$6=null,_sfc_staticRenderFns$6=null;var __component__$6=normalizeComponent(_sfc_main$6,_sfc_render$6,_sfc_staticRenderFns$6,!1,null,null,null,null);const Module=__component__$6.exports,com="_com_z9da4_2",flex="_flex_z9da4_7",style0$2={com,flex},_sfc_main$5={props:{com:{type:Object},getComDef:{type:Function},registSpm:{type:Function},context:{type:Object},scope:{type:Object},props:{type:Object},env:{type:Object},_env:{type:Object},onError:{type:Function},logger:{type:Object}},components:{SlotRender},created(){var ge;const{_env:n,env:e,com:t,props:o,getComDef:r,registSpm:p,onError:l,logger:y,context:g,scope:f}=this.$props,{pxToRem:d,pxToVw:w}=e,{id:_,def:O,name:u,slots:b={}}=t,{data:x,title:v,style:m,inputs:C,outputs:k,_inputs:E,_outputs:J,_notifyBindings:N}=o,H=this.getStyleAry({env:e,def:O,style:m});if(Array.isArray(H)){const Y=(e==null?void 0:e.shadowRoot)||((ge=document.getElementById("_mybricks-geo-webview_"))==null?void 0:ge.shadowRoot);if(!(Y||document).querySelector(`style[id="${_}"]`)){const X=document.createElement("style");let ne="";X.id=_,H.forEach(({css:oe,selector:we,global:le})=>{we===":root"&&(we="> *:first-child"),ne=ne+`
            ${le?"":`#${_} `}${we.replace(/\{id\}/g,`${_}`)} {
              ${Object.keys(oe).map($e=>{let ce=oe[$e];return d&&typeof ce=="string"&&ce.indexOf("px")!==-1?ce=pxToRem(ce):w&&typeof ce=="string"&&ce.indexOf("px")!==-1&&(ce=pxToVw(ce)),`${convertCamelToHyphen($e)}: ${ce};`}).join(`
`)}
            }
          `}),X.innerHTML=ne,Y?Y.appendChild(X):document.head.appendChild(X)}}Reflect.deleteProperty(m,"styleAry"),Reflect.deleteProperty(m,"themesId");const q=r(O),ye=[],he={};t.slots&&Object.entries(t.slots).forEach(([Y,X])=>{const ne=g.get({comId:_,slotId:Y,scope:f});he[Y]={get size(){var oe;return((oe=X==null?void 0:X.comAry)==null?void 0:oe.length)||0}},ye.push({slotId:Y,propsSlot:X,props:ne,propsStyle:m,onError:l,logger:y,env:e,_env:n,scope:f,getComDef:r,context:g})}),this.templateSlots=ye;let de;if(o.frameId&&o.parentComId){const Y=g.get({comId:o.parentComId,slotId:o.frameId,scope:f==null?void 0:f.parent});Y&&(de={get _inputs(){return new Proxy({},{get(X,ne){return Y._inputRegs[ne]}})}})}const je=this.getClasses({style:m,id:_}),Se=this.getSizeStyle({style:m,env:e}),ve=this.getMarginStyle({style:m,env:e}),G={};if(["fixed","absolute"].includes(m.position)){const{top:Y,left:X,right:ne,bottom:oe}=m;(Y||isNumber(Y))&&(G.top=isNumber(Y)?Y+"px":Y),(oe||isNumber(oe))&&(G.bottom=isNumber(oe)?oe+"px":oe),(X||isNumber(X))&&(G.left=isNumber(X)?X+"px":X),(ne||isNumber(ne))&&(G.right=isNumber(ne)?ne+"px":ne),m.position==="fixed"?G.zIndex=1e3:m.position==="absolute"&&(G.zIndex=1);const{pxToVw:we}=e;we&&(typeof G.top=="string"&&G.top.indexOf("px")!==-1&&(G.top=pxToVw(G.top)),typeof G.bottom=="string"&&G.bottom.indexOf("px")!==-1&&(G.bottom=pxToVw(G.bottom)),typeof G.left=="string"&&G.left.indexOf("px")!==-1&&(G.left=pxToVw(G.left)),typeof G.right=="string"&&G.right.indexOf("px")!==-1&&(G.right=pxToVw(G.right)))}O.namespace==="mybricks.core-comlib.module"?this.component=Module:this.component=q.runtime,this.comDef=q,this.containerProps={id:_,key:_,style:{display:m.display,position:m.position||"relative",...G,...Se,...ve,...m.ext||{}}},this.containerClass=je;const me={id:_,env:{...e,pxToVw,spm:p?p==null?void 0:p(_,{title:v,namespace:O.namespace}):null},_env:n,data:x,name:u,title:v,slots:he,propsStyle:m,inputs:C,outputs:k,_inputs:E,_outputs:J,_notifyBindings:N,parentSlot:de,onError:l,logger:y};this.componentProps={...me,m:{...me,style:m}}},methods:{getStyleAry({env:n,def:e,style:t}){var y;const o=(y=n==null?void 0:n.themes)==null?void 0:y.comThemes;if(!o)return t.styleAry;let r;const{themesId:p}=t,{namespace:l}=e;if(p)if(p==="_defined")r=t.styleAry;else{const g=o[l];if(Array.isArray(g)){const f=g.find(({id:d})=>d===p);f&&(r=f.styleAry)}}else{const g=o[l];if(Array.isArray(g)){const f=g.find(({isDefault:d})=>d);f&&(r=f.styleAry)}}return r||t.styleAry},getClasses({style:n,id:e}){const t=[e,this.$style.com];return n.flex===1&&t.push(this.$style.flex),t.join(" ")},getSizeStyle({style:n,env:e}){const t={},{width:o,height:r}=n;o?isNumber(o)?t.width=o+"px":o&&(t.width=o):t.width="100%",isNumber(r)?t.height=r+"px":r&&(t.height=r);const{pxToVw:p}=e;return p&&(typeof t.width=="string"&&t.width.indexOf("px")!==-1&&(t.width=pxToVw(t.width)),typeof t.height=="string"&&t.height.indexOf("px")!==-1&&(t.height=pxToVw(t.height))),t},getMarginStyle({style:n,env:e}){const t={},{width:o,marginTop:r,marginLeft:p,marginRight:l,marginBottom:y}=n;isNumber(r)&&(t.marginTop=r+"px"),isNumber(p)&&(typeof o=="number"||p<0?t.marginLeft=p+"px":t.paddingLeft=p+"px"),isNumber(l)&&(typeof o=="number"||l<0?t.marginRight=l+"px":t.paddingRight=l+"px"),isNumber(y)&&(t.marginBottom=y+"px");const{pxToVw:g}=e;return g&&(typeof t.marginTop=="string"&&t.marginTop.indexOf("px")!==-1&&(t.marginTop=pxToVw(t.marginTop)),typeof t.marginLeft=="string"&&t.marginLeft.indexOf("px")!==-1&&(t.marginLeft=pxToVw(t.marginLeft)),typeof t.marginRight=="string"&&t.marginRight.indexOf("px")!==-1&&(t.marginRight=pxToVw(t.marginRight)),typeof t.marginBottom=="string"&&t.marginBottom.indexOf("px")!==-1&&(t.marginBottom=pxToVw(t.marginBottom)),typeof t.paddingLeft=="string"&&t.paddingLeft.indexOf("px")!==-1&&(t.paddingLeft=pxToVw(t.paddingLeft)),typeof t.paddingRight=="string"&&t.paddingRight.indexOf("px")!==-1&&(t.paddingRight=pxToVw(t.paddingRight))),t},getSlotProps(){}}};var _sfc_render$5=function n(){var e=this,t=e._self._c;return t("div",e._b({class:e.containerClass},"div",e.containerProps,!1),[t(e.component,e._b({tag:"component",scopedSlots:e._u([e._l(e.templateSlots,function(o){return{key:o.slotId,fn:function(r){return[t("SlotRender",e._b({},"SlotRender",{...o,params:r},!1))]}}})],null,!0)},"component",e.componentProps,!1))],1)},_sfc_staticRenderFns$5=[];const __cssModules$2={$style:style0$2};function _sfc_injectStyles$2(n){for(var e in __cssModules$2)this[e]=__cssModules$2[e]}var __component__$5=normalizeComponent(_sfc_main$5,_sfc_render$5,_sfc_staticRenderFns$5,!1,_sfc_injectStyles$2,null,null,null);const RenderCom=__component__$5.exports,slot="_slot_rwhgo_1",lyFlexColumn="_lyFlexColumn_rwhgo_6",lyFlexRow="_lyFlexRow_rwhgo_10",justifyContentFlexStart="_justifyContentFlexStart_rwhgo_14",justifyContentFlexCenter="_justifyContentFlexCenter_rwhgo_17",justifyContentFlexFlexEnd="_justifyContentFlexFlexEnd_rwhgo_20",justifyContentFlexSpaceAround="_justifyContentFlexSpaceAround_rwhgo_23",justifyContentFlexSpaceBetween="_justifyContentFlexSpaceBetween_rwhgo_26",alignItemsFlexStart="_alignItemsFlexStart_rwhgo_29",alignItemsFlexCenter="_alignItemsFlexCenter_rwhgo_32",alignItemsFlexFlexEnd="_alignItemsFlexFlexEnd_rwhgo_35",debugFocus="_debugFocus_rwhgo_38",error="_error_rwhgo_42",errorRT="_errorRT_rwhgo_47",tt="_tt_rwhgo_51",info="_info_rwhgo_57",style0$1={slot,lyFlexColumn,lyFlexRow,justifyContentFlexStart,justifyContentFlexCenter,justifyContentFlexFlexEnd,justifyContentFlexSpaceAround,justifyContentFlexSpaceBetween,alignItemsFlexStart,alignItemsFlexCenter,alignItemsFlexFlexEnd,debugFocus,error,errorRT,tt,info},_sfc_main$4={props:{env:{type:Object},propsStyle:{type:Object},_env:{type:Object},propsSlot:{type:Object},getComDef:{type:Function},registSpm:{type:Function},context:{type:Object},className:{type:String},onError:{type:Function},logger:{type:Object},root:{type:Boolean},scope:{type:Object},inputs:{type:Object},outputs:{type:Object},_inputs:{type:Object},_outputs:{type:Object},params:{type:Object}},created(){},computed:{comAry(){const{env:n,_env:e,propsSlot:t,context:o,getComDef:r,registSpm:p,onError:l,logger:y,scope:g,inputs:f,_inputs:d,outputs:w,_outputs:_}=this.$props,{comAry:O}=t,u=[];return O.forEach((b,x)=>{var H;const{id:v,def:m,name:C}=b,k=o.getComInfo(v),{hasPermission:E}=n,J=(H=k==null?void 0:k.model)==null?void 0:H.permissions;if(J&&typeof E=="function"&&!E(J.id))return;if(r(m)){const q=o.get({comId:v,scope:g,_ioProxy:{inputs:f,outputs:w,_inputs:d,_outputs:_}}),ye=(g?g.id:"")+x;u.push({id:v,props:{key:ye,com:b,getComDef:r,registSpm:p,context:o,scope:g,props:q,env:n,_env:e,onError:l,logger:y},component:RenderCom,name:C,inputs:q.inputsCallable,style:q.style})}else console.error(`组件 (namespace = {${m.namespace}}）未找到.`)}),u},classes(){const{root:n,className:e,params:t,propsStyle:o}=this.$props,p=(t==null?void 0:t.style)||(t==null?void 0:t._style)||o;return`${this.calSlotClasses(p||{})}${n&&e?` ${e}`:""}`},styles(){const{root:n,propsStyle:e,params:t}=this.$props,o=(t==null?void 0:t.style)||(t==null?void 0:t._style),r=o||e;return{...this.calSlotStyles(r||{},!!o,n),...e}}},methods:{calSlotStyles(n,e,t){const{paddingLeft:o,paddingTop:r,paddingRight:p,paddingBottom:l,background:y,backgroundColor:g,backgroundImage:f,backgroundPosition:d,backgroundRepeat:w,backgroundSize:_,...O}=n;let u={paddingLeft:o||0,paddingTop:r||0,paddingRight:p||0,paddingBottom:l||0,backgroundColor:g,backgroundImage:f,backgroundPosition:d,backgroundRepeat:w,backgroundSize:_};if(y)if(typeof y=="object"){const{background:x,backgroundImage:v,backgroundColor:m,backgroundRepeat:C,backgroundSize:k}=y;u.backgroundRepeat=C,u.backgroundSize=k,x?u.background=x:(u.backgroundImage=v,u.backgroundColor=m)}else u.background=y;return e&&(u=Object.assign(u,O)),u},calSlotClasses(n){var r,p;const e=this.$style,t=[e.slot,"slot"],o=n;if(o){((r=o.layout)==null?void 0:r.toLowerCase())=="flex-column"?t.push(e.lyFlexColumn):((p=o.layout)==null?void 0:p.toLowerCase())=="flex-row"&&t.push(e.lyFlexRow);const l=o.justifyContent;l&&(l.toUpperCase()==="FLEX-START"?t.push(e.justifyContentFlexStart):l.toUpperCase()==="CENTER"?t.push(e.justifyContentFlexCenter):l.toUpperCase()==="FLEX-END"?t.push(e.justifyContentFlexFlexEnd):l.toUpperCase()==="SPACE-AROUND"?t.push(e.justifyContentFlexSpaceAround):l.toUpperCase()==="SPACE-BETWEEN"&&t.push(e.justifyContentFlexSpaceBetween));const y=o.alignItems;y&&(y.toUpperCase()==="FLEX-START"?t.push(e.alignItemsFlexStart):y.toUpperCase()==="CENTER"?t.push(e.alignItemsFlexCenter):y.toUpperCase()==="FLEX-END"&&t.push(e.alignItemsFlexFlexEnd))}return t.join(" ")}}};var _sfc_render$4=function n(){var e=this,t=e._self._c;return t("div",{class:e.classes,style:e.styles,attrs:{"data-isslot":"1"}},[e._l(e.comAry,function(o){return t(o.component,e._b({key:o.id,tag:"component"},"component",o.props,!1))}),t("div")],2)},_sfc_staticRenderFns$4=[];const __cssModules$1={$style:style0$1};function _sfc_injectStyles$1(n){for(var e in __cssModules$1)this[e]=__cssModules$1[e]}var __component__$4=normalizeComponent(_sfc_main$4,_sfc_render$4,_sfc_staticRenderFns$4,!1,_sfc_injectStyles$1,null,null,null);const RenderSlot=__component__$4.exports,_sfc_main$3={components:{RenderSlot},props:{json:{type:Object},opts:{type:Object},propsStyle:{type:Object},className:{type:String},root:{type:Boolean}},created(){const{json:n,opts:e}=this.$props;this.hasUi=n.rtType!=="js";let t={};e.comDefs&&Object.assign(t,e.comDefs);let o=[...window.__comlibs_edit_||[],...window.__comlibs_rt_||[]];o.push(coreLib),o.forEach(r=>{const p=r.comAray;p&&Array.isArray(p)&&this.regAry(p,t)}),this.comDefs=t,e.env.renderModule||(e.env.renderModule=(r,p)=>({json:r,opts:{...p,env:e.env}}));try{let r,p=!0;const l=executor({json:n,getComDef:this.getComDef,events:e.events,env:e.env,ref(y){r=y,typeof e.ref=="function"&&(e.ref(y),p=!1)},onError:this.onError,debug:e.debug,debugLogger:e.debugLogger,logger:this.logger,scenesOperate:e.scenesOperate},{observable:e.observable||Vue.observable});this.context=l,this.refs=r,this.activeTriggerInput=p}catch(r){throw console.error(r),new Error("导出的JSON.script执行异常.")}},mounted(){const{opts:n,json:e}=this.$props;if(!n.disableAutoRun){if(this.activeTriggerInput){const{inputs:t}=this.refs,o=e.inputs;t&&Array.isArray(o)&&o.forEach(r=>{const{id:p,mockData:l}=r;let y;if(n.debug&&typeof l<"u")try{y=JSON.parse(decodeURIComponent(l))}catch{y=l}t[p](y)})}this.refs.run()}},computed:{logger(){return{...console}},onError(){return n=>{console.error(n)}},props(){const{json:n,opts:e,propsStyle:t,className:o,root:r=!0}=this.$props;return{env:e.env,propsStyle:t,_env:e._env,registSpm:e.registSpm,propsSlot:n.slot,getComDef:this.getComDef,context:this.context,className:o,onError:this.onError,logger:this.logger,root:r}}},methods:{regAry(n,e){n.forEach(t=>{t.comAray?this.regAry(t.comAray,e):e[`${t.namespace}-${t.version}`]=t})},getComDef(n){const{comDefs:e}=this,t=e[n.namespace+"-"+n.version];if(!t){const o=[];for(let r in e)r.startsWith(n.namespace+"-")&&o.push(e[r]);if(o&&o.length>0){o.sort((p,l)=>compareVersion(p.version,l.version));const r=o[0];return console.warn(`【Mybricks】组件${n.namespace+"@"+n.version}未找到，使用${r.namespace}@${r.version}代替.`),r}else throw console.log(e),new Error(`组件${n.namespace+"@"+n.version}未找到，请确定是否存在该组件以及对应的版本号.`)}return t}}};var _sfc_render$3=function n(){var e=this,t=e._self._c;return e.hasUi?t("RenderSlot",e._b({},"RenderSlot",e.props,!1)):e._e()},_sfc_staticRenderFns$3=[],__component__$3=normalizeComponent(_sfc_main$3,_sfc_render$3,_sfc_staticRenderFns$3,!1,null,null,null,null);const Main=__component__$3.exports,main$1="_main_1oukw_14",slipInto="_slipInto_1oukw_1",style0={main:main$1,slipInto},_sfc_main$2={components:{Main},props:{json:{type:Object},opts:{type:Object}},data(){return{count:0,popupIds:[],pageScenes:[]}},created(){const{json:n,opts:e}=this.$props;if(e.sceneId){const g=n.scenes.findIndex(f=>f.id===e.sceneId);if(g!==-1){const f=n.scenes.splice(g,1);n.scenes.unshift(...f),f[0].type==="popup"&&this.setPopupIds([f[0].id])}}const t=[];n.scenes.forEach((g,f)=>{g.type==="popup"?f||this.setPopupIds([g.id]):t.push(g)}),this.setPageScenes(t);const{modules:o,definedComs:r}=n;if(e.env.getDefinedComJSON||(e.env.getDefinedComJSON=g=>r[g].json),e.env.getModuleJSON||(e.env.getModuleJSON=g=>{var u;const f=(u=o==null?void 0:o[g])==null?void 0:u.json;if(!f)return f;const{global:d}=n;let w={},_={},O={};return d&&(w=d.comsReg,_=d.consReg,O=d.pinRels,Object.keys(w).forEach(b=>{w[b].global=!0})),Object.assign(f.coms,w),Object.assign(f.cons,_),Object.assign(f.pinRels,O),f}),this.scenesMap=n.scenes.reduce((g,f,d)=>{var w;return{...g,[f.id]:{show:d===0,todo:[],json:f,disableAutoRun:!!d,useEntryAnimation:!1,type:((w=f.slot)==null?void 0:w.showType)||f.type}}},{}),this.scenesOperateInputsTodo={},this.themes=n.themes,this.permissions=n.permissions||[],this.globalVarMap={},e.ref){const g=e.ref;e.ref=f=>d=>(f(d),g.call(e,d))}else e.ref=g=>f=>{g(f)};const p={},l=[],{global:y}=n;if(y){const{fxFrames:g}=y;Array.isArray(g)&&g.forEach(f=>{var v;const{id:d}=f,w={};p[d]=w;const _={open({todo:m,frameId:C,parentScope:k}){const E=p[C];E!=null&&E._refs&&(E.parentScope=k,E._refs.inputs[m.pinId](m.value,void 0,!1),E._refs.run())},inputs({frameId:m,parentScope:C,value:k,pinId:E}){const J=scenesMap[m];J?(J.parentScope=C,J._refs?J._refs.inputs[E](k):J.todo=J.todo.concat({type:"inputs",todo:{pinId:E,value:k}})):scenesOperateInputsTodo[m]?scenesOperateInputsTodo[m].todo.push({frameId:m,parentScope:C,value:k,pinId:E}):scenesOperateInputsTodo[m]={parentScope:C,todo:[{value:k,pinId:E}]}},_notifyBindings(m,C){const{bindingsTo:k}=C.model;if(k)for(let E in k)for(let J in scenesMap){const N=scenesMap[J];if(N.json.coms[E])if(N._refs)this._notifyBindings(N._refs,E,k[E],m);else{const q=k[E];N.todo=N.todo.concat({type:"globalVar",todo:{comId:E,bindings:q,value:m}})}}},getGlobalComProps(m){return scenesMap[n.scenes[0].id]._refs.get({comId:m})},exeGlobalCom({com:m,value:C,pinId:k}){const E=m.id;this.globalVarMap[E]=C,Object.keys(scenesMap).forEach(N=>{const H=scenesMap[N];if(H.show&&H._refs){const q=H._refs.get({comId:E});q&&q.outputs[k](C,!0,null,!0)}});const J=e.env._context.getRefsMap();Object.entries(J).forEach(([N,H])=>{const q=H.get({comId:E});q&&q.outputs[k](C,!0,null,!0)})}},O={...e,env:{...e.env,canvas:Object.assign({id:d,type:(window==null?void 0:window.document.body.clientWidth)<=414?"mobile":"pc",open:async(m,C,k)=>{var J;let E=scenesMap[m];if(!E){if(typeof e.scenesLoader!="function"){console.error(`缺少场景信息: ${m}`);return}const N=await e.scenesLoader({id:m});if(E={disableAutoRun:!1,json:N,show:!1,parentScope:null,todo:[],type:((J=N.slot)==null?void 0:J.showType)||N.type,useEntryAnimation:!1},scenesMap[m]=E,N.type==="popup"||setPageScenes(H=>[...H,N]),scenesOperateInputsTodo[m]){const{parentScope:H,todo:q}=scenesOperateInputsTodo[m];E.parentScope=H,q.forEach(({value:ye,pinId:he,parentScope:de})=>{E.todo=E.todo.concat({type:"inputs",todo:{pinId:he,value:ye}})})}}k?Object.entries(scenesMap).forEach(([N,H])=>{N===m?(k==="blank"?H.useEntryAnimation=!0:H.useEntryAnimation=!1,H.show=!0,H.type==="popup"?this.setPopupIds([...this.popupIds,m]):setCount(q=>q+1)):(H.show=!1,H.type==="popup"?this.setPopupIds(this.popupIds.filter(q=>q!==H.json.id)):setCount(q=>q+1))}):E.show||(k==="blank"?E.useEntryAnimation=!0:E.useEntryAnimation=!1,E.show=!0,E.type==="popup"?this.setPopupIds([...this.popupIds,m]):setCount(N=>N+1))}},(v=e.env)==null?void 0:v.canvas)},disableAutoRun:!0,ref:e.ref(m=>{w._refs=m;const{inputs:C,outputs:k}=m;f.outputs.forEach(E=>{k(E.id,J=>{var N;(N=w.parentScope)==null||N.outputs[E.id](J)})})}),_env:{loadCSSLazy(){},currentScenes:{close(){}}},scenesOperate:_};let u=y.comsReg,b=y.consReg,x=y.pinRels;Object.keys(u).forEach(m=>{u[m].global=!0}),Object.assign(f.coms,u),Object.assign(f.cons,b),Object.assign(f.pinRels,x),l.push({key:d,component:Main,json:{...f,rtType:"js"},options:O})})}this.fxFramesMap=p,this.fxFramesJsx=l},computed:{scenes(){const{pageScenes:n,scenesMap:e}=this;if(!n.length)return[];const{json:t}=this.$props,{global:o}=t;let r={},p={},l={};return o&&(r=o.comsReg,p=o.consReg,l=o.pinRels,Object.keys(r).forEach(y=>{r[y].global=!0})),n.map((y,g)=>{const{id:f}=y;Object.assign(y.coms,r),Object.assign(y.cons,p),Object.assign(y.pinRels,l);const d=e[f];return{show:d.show,key:f,json:{...y,scenesMap:e},opts:this.options(f),className:d.useEntryAnimation?$style.main:"",style:d.type==="popup"?{position:"absolute",top:0,left:0,backgroundColor:"#ffffff00"}:{}}})},popups(){const{popupIds:n,scenesMap:e}=this;if(!n.length)return[];const{json:t}=this.$props,{global:o}=t;let r={},p={},l={};return o&&(r=o.comsReg,p=o.consReg,l=o.pinRels,Object.keys(r).forEach(y=>{r[y].global=!0})),n.map(y=>{const f=e[y].json,{id:d}=f;return Object.assign(f.coms,r),Object.assign(f.cons,p),Object.assign(f.pinRels,l),{key:f.id,json:{...f,scenesMap:e},opts:this.options(d),style:{position:"absolute",top:0,left:0,backgroundColor:"#ffffff00"}}})}},methods:{setCount(n){this.count=n},setPopupIds(n){this.popupIds=n},setPageScenes(n){this.pageScenes=n},options(n){var f;const{opts:e}=this.$props,{scenesMap:t,themes:o,permissions:r}=this,p=this,l=t[n],y=e.env.hasPermission,g={open({todo:d,frameId:w,parentScope:_}){const O=t[w];if(O)O.show||(O.show=!0,O.todo=O.todo.concat({type:"inputs",todo:d}),O.parentScope=_,O.type==="popup"?p.setPopupIds([...p.popupIds,w]):setCount(u=>u+1));else{const u=fxFramesMap[w];u!=null&&u._refs&&(u.parentScope=_,u._refs.inputs[d.pinId](d.value,void 0,!1),u._refs.run())}},inputs({frameId:d,parentScope:w,value:_,pinId:O}){const u=t[d];u?(u.parentScope=w,u._refs?u._refs.inputs[O](_):u.todo=u.todo.concat({type:"inputs",todo:{pinId:O,value:_}})):scenesOperateInputsTodo[d]?scenesOperateInputsTodo[d].todo.push({frameId:d,parentScope:w,value:_,pinId:O}):scenesOperateInputsTodo[d]={parentScope:w,todo:[{value:_,pinId:O}]}},_notifyBindings(d,w){const{bindingsTo:_}=w.model;if(_)for(let O in _)for(let u in t){const b=t[u];if(b.json.coms[O])if(b._refs)this._notifyBindings(b._refs,O,_[O],d);else{const v=_[O];b.todo=b.todo.concat({type:"globalVar",todo:{comId:O,bindings:v,value:d}})}}},getGlobalComProps(d){return t[json.scenes[0].id]._refs.get({comId:d})},exeGlobalCom({com:d,value:w,pinId:_}){const O=d.id;p.globalVarMap[O]=w,Object.keys(t).forEach(b=>{const x=t[b];if(x.show&&x._refs){const v=x._refs.get({comId:O});v&&v.outputs[_](w,!0,null,!0)}});const u=e.env._context.getRefsMap();Object.entries(u).forEach(([b,x])=>{const v=x.get({comId:O});v&&v.outputs[_](w,!0,null,!0)})}};return{...e,env:{...e.env,themes:o,permissions:r,hasPermission:typeof y=="function"?d=>{if(typeof d=="string"){const w=r.find(_=>_.id===d);return y({permission:w})}return y(d)}:null,canvas:Object.assign({id:n,type:(window==null?void 0:window.document.body.clientWidth)<=414?"mobile":"pc",open:async(d,w,_)=>{var u;let O=t[d];if(!O){if(typeof e.scenesLoader!="function"){console.error(`缺少场景信息: ${d}`);return}const b=await e.scenesLoader({id:d});if(O={disableAutoRun:!1,json:b,show:!1,parentScope:null,todo:[],type:((u=b.slot)==null?void 0:u.showType)||b.type,useEntryAnimation:!1},t[d]=O,b.type==="popup"||setPageScenes(x=>[...x,b]),scenesOperateInputsTodo[d]){const{parentScope:x,todo:v}=scenesOperateInputsTodo[d];O.parentScope=x,v.forEach(({value:m,pinId:C,parentScope:k})=>{O.todo=O.todo.concat({type:"inputs",todo:{pinId:C,value:m}})})}}_?Object.entries(t).forEach(([b,x])=>{b===d?(_==="blank"?x.useEntryAnimation=!0:x.useEntryAnimation=!1,x.show=!0,x.type==="popup"?p.setPopupIds([...p.popupIds,d]):setCount(v=>v+1)):(x.show=!1,x.type==="popup"?p.setPopupIds(p.popupIds.filter(v=>v!==x.json.id)):setCount(v=>v+1))}):O.show||(_==="blank"?O.useEntryAnimation=!0:O.useEntryAnimation=!1,O.show=!0,O.type==="popup"?p.setPopupIds([...p.popupIds,d]):setCount(b=>b+1))}},(f=e.env)==null?void 0:f.canvas)},get disableAutoRun(){return l.disableAutoRun},ref:e.ref(d=>{l._refs=d;const w=l.todo,{inputs:_,outputs:O}=d,u=l.disableAutoRun;l.json.outputs.forEach(b=>{O(b.id,x=>{var v;l.show=!1,l.todo=[],l._refs=null,(v=l.parentScope)==null||v.outputs[b.id](x),l.parentScope=null,l.type==="popup"?p.setPopupIds(p.popupIds.filter(m=>m!==l.json.id)):setCount(m=>m+1)})}),w.length?(w.forEach(({type:b,todo:x})=>{if(b==="inputs")Promise.resolve().then(()=>{_[x.pinId](x.value,n)});else if(b==="globalVar"){const{comId:v,value:m,bindings:C}=x;p._notifyBindings(d,v,C,m)}}),l.todo=[]):u||Promise.resolve().then(()=>{var b,x;l.disableAutoRun=!0,(x=(b=l.json.inputs)==null?void 0:b.forEach)==null||x.call(b,v=>{const{id:m,mockData:C}=v;let k;if(e.debug&&typeof C<"u")try{k=JSON.parse(decodeURIComponent(C))}catch{k=C}_[m](k)})}),u&&Promise.resolve().then(()=>{d.run()}),Object.entries(p.globalVarMap).forEach(([b,x])=>{const v=l._refs.get({comId:b});v&&v.outputs.changed(x,!0,null,!0)})}),_env:{loadCSSLazy(){},currentScenes:{close(){l.show=!1,l.todo=[],l._refs=null,l.type==="popup"?(console.log(p,"that"),p.setPopupIds(p.popupIds.filter(d=>d!==l.json.id))):setCount(d=>d+1)}}},scenesOperate:g}},_notifyBindings(n,e,t,o){const r=n.get({comId:e});r&&Array.isArray(t)&&t.forEach(p=>{let l=r;const y=p.split(".");y.forEach((g,f)=>{f!==y.length-1?l=l[g]:l[g]=o})})}}};var _sfc_render$2=function n(){var e=this,t=e._self._c;return t("div",[e._l(e.fxFramesJsx,function(o){return t(o.component,{key:o.key,tag:"component",attrs:{json:o.json,opts:o.options}})}),e._l(e.scenes,function(o){return o.show?t("Main",{key:o.key,attrs:{json:o.json,opts:o.opts,className:o.className,propsStyle:o.style}}):e._e()}),e._l(e.popups,function(o){return t("Main",{key:o.key,attrs:{json:o.json,opts:o.opts,className:o.className,propsStyle:o.style}})})],2)},_sfc_staticRenderFns$2=[];const __cssModules={$style:style0};function _sfc_injectStyles(n){for(var e in __cssModules)this[e]=__cssModules[e]}var __component__$2=normalizeComponent(_sfc_main$2,_sfc_render$2,_sfc_staticRenderFns$2,!1,_sfc_injectStyles,null,null,null);const MultiScene=__component__$2.exports;class Context{constructor(){He(this,"_refsMap",{})}setRefs(e,t){this._refsMap[e]=t}getRefsMap(){return this._refsMap}}const _sfc_main$1={functional:!0,render(n,{props:e}){const{json:t,opts:o}=e;if(!t)return null;o.env._context||(o.env._context=new Context);const r=Array.isArray(t.scenes),p=r?MultiScene:Main;return!r&&t.type==="module"&&(e.root=!1),n(p,{props:e},[])}},_sfc_render$1=null,_sfc_staticRenderFns$1=null;var __component__$1=normalizeComponent(_sfc_main$1,_sfc_render$1,_sfc_staticRenderFns$1,!1,null,null,null,null);const Render=__component__$1.exports,_sfc_main={components:{Render},props:{json:{type:Object},opts:{type:Object}}};var _sfc_render=function n(){var e=this,t=e._self._c;return t("Render",e._b({},"Render",this.$props,!1))},_sfc_staticRenderFns=[],__component__=normalizeComponent(_sfc_main,_sfc_render,_sfc_staticRenderFns,!1,null,null,null,null);const App=__component__.exports,name="@mybricks/render-web-vue2",version="0.0.5",description="",main="dist/index.mjs",scripts={dev:"vite",build:"vite build --config vite.build.js"},keywords=[],author="",license="ISC",dependencies={"@mybricks/comlib-core":"^0.0.36",vue:"^2.7.14"},devDependencies={"@vitejs/plugin-vue2":"^2.2.0",less:"^4.2.0",vite:"^4.4.9"},pkg={name,version,description,main,scripts,keywords,author,license,dependencies,devDependencies};console.log(`%c ${pkg.name} %c@${pkg.version}`,"color:#FFF;background:#fa6400","","");function render(n,e){return Vue.extend({render:t=>t(App,{props:{json:n,opts:e}})})}window["mybricks-render-vue2"]=function n({json:e,opts:t},o){new Vue({render:r=>r(App,{props:{json:e,opts:t}},[])}).$mount(o)},exports.render=render,Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"})});
